<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<title>The Silent Signal</title>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THE SILENT SIGNAL â€” ULTIMATE ROMANTIC CSS
   âœ¨ Aurora backgrounds, neon glows, particle effects,
   floating hearts, glass morphism, shimmer text,
   3D card flips, liquid buttons, and MORE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
    --bg:#06040d;--surface:rgba(255,255,255,0.025);
    --card-bg:rgba(255,255,255,0.035);--border:rgba(255,255,255,0.06);
    --border-glow:rgba(255,20,147,0.5);
    --primary:#FF1493;--primary-rgb:255,20,147;
    --secondary:#FF4081;--secondary-rgb:255,64,129;
    --neon-pink:#FF10F0;--neon-purple:#B026FF;--neon-blue:#00D4FF;
    --soft-pink:#FF80AB;--deep-purple:#7B2FBE;--hot:#FF006E;
    --text:#fff;--text-dim:rgba(255,255,255,0.55);--text-muted:rgba(255,255,255,0.25);
    --font-display:'Orbitron',monospace;
    --font-body:'Space Grotesk',sans-serif;
    --font-accent:'Rajdhani',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{width:100%;height:100%;overflow:hidden;font-family:var(--font-body);background:var(--bg);color:var(--text);user-select:none}

/* â•â•â• AURORA â•â•â• */
.aurora{position:fixed;inset:0;z-index:0;
    background:radial-gradient(ellipse at 10% 20%,rgba(var(--primary-rgb),0.07) 0%,transparent 50%),
    radial-gradient(ellipse at 90% 80%,rgba(176,38,255,0.05) 0%,transparent 50%),
    radial-gradient(ellipse at 50% 0%,rgba(0,212,255,0.03) 0%,transparent 40%),
    radial-gradient(ellipse at 50% 100%,rgba(var(--secondary-rgb),0.04) 0%,transparent 40%),var(--bg)}
.aurora-orb{position:absolute;border-radius:50%;filter:blur(80px);animation:aOrbDrift 20s ease-in-out infinite;mix-blend-mode:screen}
.ao1{width:50vw;height:50vw;top:-15%;left:-10%;background:radial-gradient(circle,rgba(var(--primary-rgb),0.12),transparent 70%);animation-duration:22s}
.ao2{width:45vw;height:45vw;bottom:-20%;right:-15%;background:radial-gradient(circle,rgba(176,38,255,0.1),transparent 70%);animation-duration:18s;animation-delay:-8s}
.ao3{width:30vw;height:30vw;top:40%;left:50%;transform:translateX(-50%);background:radial-gradient(circle,rgba(0,212,255,0.06),transparent 70%);animation-duration:25s;animation-delay:-4s}
@keyframes aOrbDrift{0%,100%{transform:translate(0,0) scale(1);opacity:.5}25%{transform:translate(5%,-8%) scale(1.15);opacity:.7}50%{transform:translate(-3%,5%) scale(.9);opacity:.4}75%{transform:translate(4%,3%) scale(1.1);opacity:.6}}
.grid-ov{position:fixed;inset:0;z-index:1;pointer-events:none;background-image:linear-gradient(rgba(255,255,255,0.008) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.008) 1px,transparent 1px);background-size:50px 50px}
.scanln{position:fixed;inset:0;z-index:2;pointer-events:none;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.03) 2px,rgba(0,0,0,0.03) 4px)}

/* â•â•â• PARTICLES â•â•â• */
.particles{position:fixed;inset:0;z-index:3;pointer-events:none;overflow:hidden}
.ptc{position:absolute;opacity:0;animation:ptcRise linear infinite}
.ptc-dot{border-radius:50%;background:rgba(var(--primary-rgb),0.4);box-shadow:0 0 6px rgba(var(--primary-rgb),0.3)}
.ptc-heart{filter:drop-shadow(0 0 4px rgba(var(--primary-rgb),0.4))}
.ptc-star{color:rgba(var(--primary-rgb),0.25);text-shadow:0 0 8px rgba(var(--primary-rgb),0.2)}
.ptc-sparkle{background:#fff;border-radius:50%;box-shadow:0 0 4px #fff,0 0 8px rgba(var(--primary-rgb),0.3)}
@keyframes ptcRise{0%{transform:translateY(110vh) translateX(0) rotate(0) scale(0);opacity:0}4%{opacity:.6;transform:translateY(100vh) scale(1)}50%{transform:translateY(50vh) translateX(-10px) rotate(180deg) scale(.9);opacity:.3}100%{transform:translateY(-5vh) rotate(360deg) scale(.3);opacity:0}}

/* â•â•â• GLASS â•â•â• */
.glass{background:rgba(255,255,255,0.03);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);border:1px solid rgba(255,255,255,0.06);box-shadow:0 8px 32px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.04)}
.neon-border{position:relative;overflow:hidden}
.neon-border::before{content:'';position:absolute;top:-1px;left:15%;right:15%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.5),rgba(176,38,255,0.3),transparent);animation:neonSlide 4s ease-in-out infinite}
@keyframes neonSlide{0%,100%{left:15%;right:15%;opacity:.5}50%{left:25%;right:25%;opacity:1}}
.breath-border{animation:breathGlow 4s ease-in-out infinite}
@keyframes breathGlow{0%,100%{border-color:rgba(255,255,255,0.04)}50%{border-color:rgba(var(--primary-rgb),0.15);box-shadow:0 0 20px rgba(var(--primary-rgb),0.05)}}

/* â•â•â• SHIMMER + GRADIENT TEXT â•â•â• */
.shimmer-text{background:linear-gradient(120deg,rgba(255,255,255,.5) 0%,var(--primary) 20%,var(--neon-purple) 40%,var(--primary) 60%,rgba(255,255,255,.8) 75%,var(--primary) 100%);background-size:300% 100%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;animation:shimmer 6s linear infinite}
@keyframes shimmer{0%{background-position:300% 0}100%{background-position:-300% 0}}
.gradient-text{background:linear-gradient(135deg,var(--primary),var(--neon-purple),var(--primary));background-size:200% 200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;animation:gradShift 4s ease infinite}
@keyframes gradShift{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}

/* â•â•â• LIQUID BUTTON â•â•â• */
.liquid-btn{position:relative;overflow:hidden;border:none;border-radius:14px;padding:15px 30px;cursor:pointer;font-family:var(--font-display);font-size:12px;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:#fff;background:linear-gradient(135deg,var(--primary),var(--deep-purple),var(--hot),var(--primary));background-size:300% 300%;animation:liquidFlow 6s ease infinite;box-shadow:0 4px 15px rgba(var(--primary-rgb),0.3);transition:all .3s}
@keyframes liquidFlow{0%{background-position:0% 50%}25%{background-position:50% 0%}50%{background-position:100% 50%}75%{background-position:50% 100%}100%{background-position:0% 50%}}
.liquid-btn::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent 40%,rgba(255,255,255,0.05) 44%,rgba(255,255,255,0.15) 50%,rgba(255,255,255,0.05) 56%,transparent 60%);animation:liqShine 4s infinite}
@keyframes liqShine{0%{transform:translateX(-100%) rotate(25deg)}100%{transform:translateX(100%) rotate(25deg)}}
.liquid-btn::after{content:'';position:absolute;width:120%;height:120%;top:-10%;left:-10%;border-radius:40% 60% 70% 30%/40% 50% 60% 50%;background:linear-gradient(135deg,rgba(var(--primary-rgb),0.2),rgba(176,38,255,0.15));z-index:-1;filter:blur(20px);animation:blobMorph 8s ease-in-out infinite}
@keyframes blobMorph{0%,100%{border-radius:40% 60% 70% 30%/40% 50% 60% 50%}25%{border-radius:70% 30% 50% 50%/30% 30% 70% 70%}50%{border-radius:30% 60% 70% 40%/50% 60% 30% 60%}75%{border-radius:60% 40% 30% 70%/60% 30% 70% 40%}}
.liquid-btn:active{transform:scale(.95);box-shadow:0 2px 10px rgba(var(--primary-rgb),0.4)}
.liquid-btn.loading{pointer-events:none;opacity:.7}
.liquid-btn.loading .btn-text{visibility:hidden}
.liquid-btn.loading::after{display:none}
.liquid-btn.loading .spinner{position:absolute;top:50%;left:50%;margin:-10px 0 0 -10px;width:20px;height:20px;border:2px solid rgba(255,255,255,.2);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* â•â•â• 3D CARDS â•â•â• */
.card-3d{transition:transform .4s cubic-bezier(.4,0,.2,1),box-shadow .4s;transform-style:preserve-3d;will-change:transform}
.card-3d:active{transform:rotateX(4deg) rotateY(-2deg) scale(.96);box-shadow:0 15px 35px rgba(0,0,0,0.4),0 0 25px rgba(var(--primary-rgb),0.15)}

/* â•â•â• PAGES â•â•â• */
.page{position:fixed;inset:0;display:none;flex-direction:column;z-index:10;overflow:hidden}
.page.active{display:flex}
.page.anim-slide{animation:pgSlide .4s cubic-bezier(.16,1,.3,1)}
.page.anim-fade{animation:pgFade .35s ease}
.page.anim-scale{animation:pgScale .45s cubic-bezier(.16,1,.3,1)}
@keyframes pgSlide{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes pgFade{from{opacity:0}to{opacity:1}}
@keyframes pgScale{from{transform:scale(.92);opacity:0;filter:blur(5px)}to{transform:scale(1);opacity:1;filter:blur(0)}}

/* â•â•â• SPLASH â•â•â• */
#pg-splash{justify-content:center;align-items:center;background:radial-gradient(ellipse at 50% 40%,rgba(var(--primary-rgb),0.06),var(--bg) 70%)}
.sp-wrap{text-align:center;position:relative}
.sp-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,rgba(var(--primary-rgb),0.1),transparent 70%);animation:spGP 3s ease-in-out infinite}
.sp-glow2{width:280px;height:280px;background:radial-gradient(circle,rgba(176,38,255,0.06),transparent 70%);animation-delay:1.5s}
@keyframes spGP{0%,100%{transform:translate(-50%,-50%) scale(1);opacity:.4}50%{transform:translate(-50%,-50%) scale(1.5);opacity:.8}}
.sp-pulse{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}
.sp-ring{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:80px;height:80px;border-radius:50%;border:1px solid rgba(var(--primary-rgb),0.12);animation:spRE 3.5s ease-out infinite}
.sp-ring:nth-child(2){animation-delay:1.2s}.sp-ring:nth-child(3){animation-delay:2.4s;width:60px;height:60px;border-color:rgba(176,38,255,0.1)}
@keyframes spRE{0%{transform:translate(-50%,-50%) scale(.5);opacity:.7}100%{transform:translate(-50%,-50%) scale(4);opacity:0}}
.sp-icon{font-size:64px;position:relative;z-index:2;animation:spHB 1.8s ease-in-out infinite;filter:drop-shadow(0 0 25px rgba(var(--primary-rgb),0.4))}
@keyframes spHB{0%,100%{transform:scale(1)}15%{transform:scale(1.15)}30%{transform:scale(1)}45%{transform:scale(1.1)}}
.sp-brand{margin-top:30px;font-family:var(--font-display);font-size:15px;font-weight:800;letter-spacing:7px;text-transform:uppercase;animation:fadeUp .8s ease .5s both}
.sp-line{width:50px;height:1px;margin:16px auto;background:linear-gradient(90deg,transparent,var(--primary),var(--neon-purple),transparent);animation:fadeUp .8s ease .8s both}
.sp-sub{font-family:var(--font-accent);font-size:12px;color:var(--text-muted);letter-spacing:4px;text-transform:uppercase;animation:fadeUp .8s ease 1.1s both}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
.sp-loader{display:flex;gap:8px;justify-content:center;margin-top:45px;animation:fadeUp .8s ease 1.4s both}
.sp-ldot{width:6px;height:6px;border-radius:50%;background:var(--primary);box-shadow:0 0 10px rgba(var(--primary-rgb),0.5);animation:spDP 1.6s ease-in-out infinite}
.sp-ldot:nth-child(2){animation-delay:.2s}.sp-ldot:nth-child(3){animation-delay:.4s}
@keyframes spDP{0%,100%{opacity:.2;transform:scale(.7)}50%{opacity:1;transform:scale(1.4)}}

/* â•â•â• LOGIN â•â•â• */
#pg-login{justify-content:center;align-items:center;padding:24px;background:radial-gradient(ellipse at 50% 30%,rgba(var(--primary-rgb),0.03),transparent 60%)}
.login-card{width:100%;max-width:360px;padding:40px 26px;border-radius:24px;text-align:center;position:relative;animation:pgScale .5s cubic-bezier(.16,1,.3,1)}
.login-icon{font-size:44px;margin-bottom:10px;animation:lFloat 4s ease-in-out infinite;filter:drop-shadow(0 0 20px rgba(var(--primary-rgb),0.3))}
@keyframes lFloat{0%,100%{transform:translateY(0)}25%{transform:translateY(-8px) rotate(3deg)}75%{transform:translateY(-4px) rotate(-2deg)}}
.login-title{font-family:var(--font-display);font-size:13px;font-weight:700;letter-spacing:4px;text-transform:uppercase}
.login-sub{font-family:var(--font-accent);font-size:13px;color:var(--text-muted);margin:6px 0 30px;letter-spacing:1px}
.inp-group{position:relative;margin-bottom:16px;text-align:left}
.inp-label{font-family:var(--font-display);font-size:8px;font-weight:500;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase;margin-bottom:8px;display:block;padding-left:2px}
.inp{width:100%;padding:14px 16px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,0.02);color:#fff;font-family:var(--font-body);font-size:14px;outline:none;transition:all .4s}
.inp:focus{border-color:rgba(var(--primary-rgb),0.4);background:rgba(255,255,255,0.04);box-shadow:0 0 0 3px rgba(var(--primary-rgb),0.06),0 0 25px rgba(var(--primary-rgb),0.05)}
.inp::placeholder{color:rgba(255,255,255,0.12);font-weight:300}
.login-error{font-family:var(--font-accent);color:var(--soft-pink);font-size:12px;margin-top:14px;min-height:18px}
.shake{animation:shakeIt .5s cubic-bezier(.36,.07,.19,.97)}
@keyframes shakeIt{10%,90%{transform:translateX(-3px)}20%,80%{transform:translateX(5px)}30%,50%,70%{transform:translateX(-7px)}40%,60%{transform:translateX(7px)}}

/* â•â•â• NAV BAR â•â•â• */
.nav-bar{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;padding-top:max(14px,env(safe-area-inset-top));border-bottom:1px solid var(--border);background:rgba(6,4,13,0.85);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);z-index:5;position:relative}
.nav-bar::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.15),transparent)}
.nav-left{display:flex;align-items:center;gap:10px}
.nav-icon{font-size:18px;filter:drop-shadow(0 0 8px rgba(var(--primary-rgb),0.4));animation:navIP 3s ease-in-out infinite}
@keyframes navIP{0%,100%{filter:drop-shadow(0 0 5px rgba(var(--primary-rgb),.3))}50%{filter:drop-shadow(0 0 15px rgba(var(--primary-rgb),.6))}}
.nav-title{font-family:var(--font-display);font-size:10px;font-weight:600;letter-spacing:2px;text-transform:uppercase}
.nav-right{display:flex;align-items:center;gap:14px}
.nav-status{display:flex;align-items:center;gap:5px;font-family:var(--font-accent);font-size:11px;color:var(--text-dim)}
.status-dot{width:7px;height:7px;border-radius:50%;box-shadow:0 0 10px currentColor;animation:stPulse 2s ease-in-out infinite}
@keyframes stPulse{0%,100%{box-shadow:0 0 5px currentColor}50%{box-shadow:0 0 15px currentColor,0 0 25px currentColor}}
.s-on{background:#4ADE80;color:#4ADE80}.s-off{background:#FF6B9D;color:#FF6B9D}
.nav-avatar{width:34px;height:34px;border-radius:10px;background:var(--card-bg);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer;transition:all .3s}
.nav-avatar:active{transform:scale(.88);border-color:var(--border-glow)}

/* â•â•â• PG HEADER â•â•â• */
.pg-header{display:flex;align-items:center;gap:14px;padding:14px 16px;padding-top:max(14px,env(safe-area-inset-top));border-bottom:1px solid var(--border);background:rgba(6,4,13,0.85);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);z-index:5;position:relative}
.pg-header::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.1),transparent)}
.btn-back{width:38px;height:38px;border-radius:10px;border:1px solid var(--border);background:var(--card-bg);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .25s}
.btn-back:active{transform:scale(.85);border-color:var(--border-glow)}
.pg-title{font-family:var(--font-display);font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase}
.pg-body{flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}

/* â•â•â• HOME â•â•â• */
.home-scroll{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:40px}
.greeting-banner{margin:20px 16px;padding:26px 20px;border-radius:22px;text-align:center;position:relative;overflow:hidden;animation:pgScale .5s cubic-bezier(.16,1,.3,1);background:linear-gradient(135deg,rgba(var(--primary-rgb),0.06),rgba(176,38,255,0.03))}
.greeting-banner::before{content:'';position:absolute;top:0;left:15%;right:15%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.3),rgba(176,38,255,0.2),transparent);animation:neonSlide 5s ease-in-out infinite}
.greeting-banner::after{content:'';position:absolute;bottom:0;left:20%;right:20%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.1),transparent)}
.greet-emoji{font-size:40px;display:block;margin-bottom:10px;animation:gFloat 5s ease-in-out infinite;filter:drop-shadow(0 0 15px rgba(var(--primary-rgb),0.2))}
@keyframes gFloat{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-8px) scale(1.05)}}
.greeting-name{font-family:var(--font-display);font-size:16px;font-weight:700}
.greeting-name span{color:var(--primary);text-shadow:0 0 20px rgba(var(--primary-rgb),0.3)}
.greeting-date{font-family:var(--font-accent);color:var(--soft-pink);font-size:14px;margin-top:6px}
.greeting-tagline{font-family:var(--font-accent);color:rgba(255,128,171,0.35);font-size:12px;margin-top:4px;font-style:italic}

.quick-row{display:flex;gap:10px;padding:0 16px;margin:18px 0;overflow-x:auto;scrollbar-width:none}
.quick-row::-webkit-scrollbar{display:none}
.quick-btn{flex-shrink:0;padding:10px 20px;border-radius:50px;border:1px solid var(--border);background:var(--card-bg);color:var(--soft-pink);font-family:var(--font-accent);font-size:13px;cursor:pointer;white-space:nowrap;transition:all .3s;position:relative;overflow:hidden}
.quick-btn:active{background:rgba(var(--primary-rgb),0.1);border-color:rgba(var(--primary-rgb),0.3);color:#fff;transform:scale(.96)}

.section-label{font-family:var(--font-display);font-size:9px;font-weight:600;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;padding:0 16px;margin:22px 0 16px}

/* â•â•â• FEATURE GRID â•â•â• */
.section-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:0 16px;perspective:600px}
.section-card{background:var(--card-bg);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:18px;padding:20px 10px;text-align:center;cursor:pointer;position:relative;overflow:hidden;transition:all .35s cubic-bezier(.4,0,.2,1);transform-style:preserve-3d}
.section-card::before{content:'';position:absolute;top:0;left:25%;right:25%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.2),transparent);opacity:0;transition:opacity .3s}
.section-card::after{content:'';position:absolute;inset:0;border-radius:inherit;background:radial-gradient(circle at 50% 30%,rgba(var(--primary-rgb),0.06),transparent 60%);opacity:0;transition:opacity .3s;pointer-events:none}
.section-card:active{transform:scale(.95) rotateX(3deg);border-color:rgba(var(--primary-rgb),0.25);box-shadow:0 8px 30px rgba(0,0,0,0.3),0 0 20px rgba(var(--primary-rgb),0.1)}
.section-card:active::before,.section-card:active::after{opacity:1}
.card-icon{font-size:30px;display:block;margin-bottom:8px;transition:all .35s;filter:drop-shadow(0 2px 8px rgba(0,0,0,0.3))}
.section-card:active .card-icon{transform:scale(1.2) rotate(8deg) translateY(-3px);filter:drop-shadow(0 4px 12px rgba(var(--primary-rgb),0.3))}
.card-name{font-family:var(--font-display);font-size:8px;font-weight:600;color:rgba(255,255,255,0.85);letter-spacing:1.5px;text-transform:uppercase;line-height:1.3}
.card-sub{font-family:var(--font-accent);font-size:10px;color:var(--soft-pink);margin-top:3px;display:block;opacity:.5}

.section-card{opacity:0;animation:cardRev .5s cubic-bezier(.16,1,.3,1) forwards}
.section-card:nth-child(1){animation-delay:.04s}.section-card:nth-child(2){animation-delay:.08s}.section-card:nth-child(3){animation-delay:.12s}
.section-card:nth-child(4){animation-delay:.18s}.section-card:nth-child(5){animation-delay:.24s}.section-card:nth-child(6){animation-delay:.30s}
.section-card:nth-child(7){animation-delay:.36s}.section-card:nth-child(8){animation-delay:.42s}.section-card:nth-child(9){animation-delay:.48s}
@keyframes cardRev{from{opacity:0;transform:translateY(20px) scale(.92) rotateX(8deg)}to{opacity:1;transform:translateY(0) scale(1) rotateX(0)}}

/* Unread badge */
.unread-badge{position:absolute;top:8px;right:8px;min-width:18px;height:18px;border-radius:50%;background:var(--primary);color:#fff;font-family:var(--font-display);font-size:7px;font-weight:700;display:flex;align-items:center;justify-content:center;box-shadow:0 0 10px rgba(var(--primary-rgb),0.5);animation:badgePulse 2s ease-in-out infinite;padding:0 4px}
@keyframes badgePulse{0%,100%{box-shadow:0 0 5px rgba(var(--primary-rgb),.3)}50%{box-shadow:0 0 15px rgba(var(--primary-rgb),.6)}}

/* â•â•â• SYNC â•â•â• */
.sync-section{margin:24px 16px 0;padding:20px;border-radius:18px;position:relative;overflow:hidden;animation:pgFade .5s ease .5s both}
.sync-section::before{content:'';position:absolute;top:0;left:20%;right:20%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.15),transparent)}
.sync-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.sync-label{font-family:var(--font-display);font-size:9px;font-weight:600;letter-spacing:2px;text-transform:uppercase}
.sync-pct{font-family:var(--font-accent);font-size:20px;font-weight:700;color:var(--secondary);text-shadow:0 0 15px rgba(var(--secondary-rgb),0.3)}
.sync-bar-bg{width:100%;height:4px;border-radius:4px;background:rgba(255,255,255,0.03);overflow:hidden}
.sync-bar{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--primary),var(--neon-purple),var(--secondary));background-size:200% 100%;box-shadow:0 0 12px rgba(var(--primary-rgb),0.3);animation:syncG 3s ease-in-out infinite,syncF 4s linear infinite;transition:width 1.8s cubic-bezier(.4,0,.2,1)}
@keyframes syncG{0%,100%{box-shadow:0 0 8px rgba(var(--primary-rgb),.2)}50%{box-shadow:0 0 18px rgba(var(--primary-rgb),.5)}}
@keyframes syncF{0%{background-position:200% 0}100%{background-position:-200% 0}}

.quote-section{margin:16px 16px 0;padding:18px 20px;border-radius:18px;text-align:center;animation:pgFade .5s ease .6s both;position:relative;overflow:hidden}
.quote-section::before{content:'';position:absolute;top:0;left:30%;right:30%;height:1px;background:linear-gradient(90deg,transparent,rgba(176,38,255,0.15),transparent)}
.quote-icon{font-size:14px;display:block;margin-bottom:8px;opacity:.4}
.quote-text{font-family:var(--font-accent);font-size:13px;color:rgba(255,128,171,0.4);line-height:1.7;font-style:italic}

.home-ft{text-align:center;padding:35px 0 15px;font-family:var(--font-accent);font-size:10px;color:rgba(255,255,255,0.06);letter-spacing:3px}

/* â•â•â• PLACEHOLDER â•â•â• */
.ph-wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;height:70vh;text-align:center;padding:20px}
.ph-icon{font-size:64px;margin-bottom:18px;animation:gFloat 3s ease-in-out infinite;filter:drop-shadow(0 0 20px rgba(var(--primary-rgb),0.2))}
.ph-title{font-family:var(--font-display);font-size:13px;font-weight:700;color:rgba(255,255,255,.6);letter-spacing:3px;text-transform:uppercase}
.ph-sub{font-family:var(--font-accent);color:var(--text-muted);font-size:14px;margin-top:8px}
.ph-badge{margin-top:22px;padding:9px 22px;border-radius:50px;font-family:var(--font-display);font-size:8px;font-weight:600;color:var(--text-muted);letter-spacing:2px;text-transform:uppercase;border:1px solid var(--border);background:var(--card-bg)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ’¬ CHAT â€” ULTIMATE CHAT UI
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Chat Header */
.chat-header{display:flex;align-items:center;gap:12px;padding:12px 16px;padding-top:max(12px,env(safe-area-inset-top));border-bottom:1px solid var(--border);background:rgba(6,4,13,0.9);backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);z-index:5;position:relative}
.chat-header::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.12),transparent)}
.chat-hdr-info{flex:1}
.chat-hdr-name{font-family:var(--font-display);font-size:12px;font-weight:600;letter-spacing:1.5px;color:#fff;text-transform:uppercase}
.chat-hdr-status{display:flex;align-items:center;gap:5px;font-family:var(--font-accent);font-size:11px;color:var(--text-dim);margin-top:2px}
.chat-hdr-avatar{width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,rgba(var(--primary-rgb),0.1),rgba(176,38,255,0.08));border:1px solid rgba(var(--primary-rgb),0.15);display:flex;align-items:center;justify-content:center;font-size:20px;box-shadow:0 0 15px rgba(var(--primary-rgb),0.1)}

/* Messages Area */
.chat-msgs{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:16px;display:flex;flex-direction:column;gap:6px;background:radial-gradient(ellipse at 50% 100%,rgba(var(--primary-rgb),0.02),transparent 60%)}

/* Empty State */
.chat-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;opacity:.5}
.chat-empty-icon{font-size:60px;margin-bottom:14px;animation:gFloat 3s ease-in-out infinite}
.chat-empty-text{font-family:var(--font-display);font-size:12px;letter-spacing:2px;color:var(--text-muted);text-transform:uppercase}
.chat-empty-sub{font-family:var(--font-accent);font-size:13px;color:rgba(var(--primary-rgb),0.3);margin-top:4px}

/* Date Separator */
.msg-date-sep{text-align:center;padding:12px 0 8px;position:relative}
.msg-date-sep span{font-family:var(--font-display);font-size:8px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text-muted);background:var(--bg);padding:0 14px;position:relative;z-index:1}
.msg-date-sep::before{content:'';position:absolute;top:50%;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}

/* Message Row */
.msg-row{display:flex;max-width:82%;animation:msgIn .3s cubic-bezier(.16,1,.3,1)}
.msg-row.sent{align-self:flex-end}
.msg-row.received{align-self:flex-start}
@keyframes msgIn{from{opacity:0;transform:translateY(12px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}

/* Message Bubble */
.msg-bubble{padding:10px 14px;border-radius:18px;font-size:14px;line-height:1.55;word-wrap:break-word;word-break:break-word;position:relative;max-width:100%}
.sent .msg-bubble{background:linear-gradient(135deg,rgba(var(--primary-rgb),0.18),rgba(176,38,255,0.12));border:1px solid rgba(var(--primary-rgb),0.12);border-bottom-right-radius:6px;color:rgba(255,255,255,0.92)}
.sent .msg-bubble::before{content:'';position:absolute;inset:0;border-radius:inherit;background:radial-gradient(circle at 20% 20%,rgba(255,255,255,0.04),transparent 60%);pointer-events:none}
.received .msg-bubble{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.05);border-bottom-left-radius:6px;color:rgba(255,255,255,0.8)}
.msg-text{font-family:var(--font-body);font-size:13.5px}
.msg-time{font-family:var(--font-accent);font-size:10px;color:rgba(255,255,255,0.2);margin-top:4px;display:flex;align-items:center;gap:4px}
.sent .msg-time{justify-content:flex-end}
.msg-check{font-size:10px;color:rgba(var(--primary-rgb),0.4)}
.msg-check.read{color:rgba(var(--primary-rgb),0.8)}

/* Typing Indicator */
.typing-wrap{padding:4px 16px 8px;display:none;align-items:center;gap:8px;animation:pgFade .3s ease}
.typing-wrap.show{display:flex}
.typing-dots{display:flex;gap:3px;padding:8px 12px;background:rgba(255,255,255,0.04);border-radius:18px;border:1px solid rgba(255,255,255,0.04)}
.typing-dots span{width:6px;height:6px;border-radius:50%;background:var(--primary);opacity:.3;animation:typDot 1.4s ease-in-out infinite}
.typing-dots span:nth-child(2){animation-delay:.2s}
.typing-dots span:nth-child(3){animation-delay:.4s}
@keyframes typDot{0%,100%{opacity:.2;transform:scale(.7)}50%{opacity:.8;transform:scale(1.2)}}
.typing-label{font-family:var(--font-accent);font-size:11px;color:var(--text-muted)}

/* Input Area */
.chat-input-area{display:flex;align-items:flex-end;gap:10px;padding:12px 16px;padding-bottom:max(12px,env(safe-area-inset-bottom));border-top:1px solid var(--border);background:rgba(6,4,13,0.9);backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);position:relative}
.chat-input-area::before{content:'';position:absolute;top:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.08),transparent)}
.chat-inp-wrap{flex:1;position:relative}
.chat-inp{width:100%;padding:12px 18px;border-radius:24px;border:1px solid var(--border);background:rgba(255,255,255,0.025);color:#fff;font-family:var(--font-body);font-size:14px;outline:none;transition:all .3s;resize:none}
.chat-inp:focus{border-color:rgba(var(--primary-rgb),0.25);background:rgba(255,255,255,0.04);box-shadow:0 0 20px rgba(var(--primary-rgb),0.04)}
.chat-inp::placeholder{color:rgba(255,255,255,0.12);font-weight:300}
.chat-send{width:44px;height:44px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;transition:all .3s;background:linear-gradient(135deg,var(--primary),var(--deep-purple));color:#fff;box-shadow:0 4px 15px rgba(var(--primary-rgb),0.25),0 0 20px rgba(var(--primary-rgb),0.08);position:relative;overflow:hidden}
.chat-send::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,0.15),transparent 60%);pointer-events:none}
.chat-send:active{transform:scale(.88);box-shadow:0 2px 8px rgba(var(--primary-rgb),0.4)}
.chat-send.disabled{opacity:.3;pointer-events:none;box-shadow:none}

/* New message notification */
.new-msg-toast{position:absolute;bottom:80px;left:50%;transform:translateX(-50%);padding:8px 20px;border-radius:50px;background:rgba(var(--primary-rgb),0.15);border:1px solid rgba(var(--primary-rgb),0.2);backdrop-filter:blur(15px);font-family:var(--font-accent);font-size:12px;color:var(--soft-pink);cursor:pointer;animation:toastIn .3s ease;white-space:nowrap;z-index:5;display:none}
@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(10px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}

/* â•â•â• RIPPLE â•â•â• */
.ripple{position:absolute;border-radius:50%;background:radial-gradient(circle,rgba(var(--primary-rgb),0.2),transparent 70%);transform:scale(0);animation:rippleOut .7s ease-out;pointer-events:none}
@keyframes rippleOut{to{transform:scale(4);opacity:0}}

/* â•â•â• SCROLLBAR â•â•â• */
::-webkit-scrollbar{width:2px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:rgba(var(--primary-rgb),0.1);border-radius:10px}

/* â•â•â• RESPONSIVE â•â•â• */
@media(max-width:768px){.section-grid{gap:10px;padding:0 14px}.section-card{padding:16px 8px}.card-icon{font-size:26px}.card-name{font-size:7px}.card-sub{font-size:9px}}
@media(max-width:360px){.section-grid{gap:8px;padding:0 12px}.section-card{padding:14px 6px;border-radius:14px}.card-icon{font-size:22px}.greeting-name{font-size:14px}.quick-btn{padding:8px 14px;font-size:12px}}
</style>
</head>
<body>

<div class="aurora"><div class="aurora-orb ao1"></div><div class="aurora-orb ao2"></div><div class="aurora-orb ao3"></div></div>
<div class="grid-ov"></div><div class="scanln"></div>
<div class="particles" id="ptcBg"></div>

<!-- SPLASH -->
<div class="page active" id="pg-splash">
<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%">
    <div class="sp-wrap"><div class="sp-glow"></div><div class="sp-glow sp-glow2"></div>
    <div class="sp-pulse"><div class="sp-ring"></div><div class="sp-ring"></div><div class="sp-ring"></div></div>
    <div class="sp-icon">ğŸ¤«</div></div>
    <div class="sp-brand shimmer-text">The Silent Signal</div>
    <div class="sp-line"></div><div class="sp-sub">only for us</div>
    <div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div>
</div></div>

<!-- LOGIN -->
<div class="page" id="pg-login">
<div style="flex:1;display:flex;align-items:center;justify-content:center;padding:24px">
    <div class="login-card glass neon-border breath-border" id="loginCard">
        <div class="login-icon">ğŸ¤«</div>
        <div class="login-title shimmer-text">Silent Signal</div>
        <div class="login-sub">enter your signal to connect</div>
        <div class="inp-group"><label class="inp-label">Username</label><input class="inp" type="text" id="inpUser" placeholder="enter username" autocomplete="off" autocapitalize="off"></div>
        <div class="inp-group"><label class="inp-label">Password</label><input class="inp" type="password" id="inpPass" placeholder="enter password"></div>
        <button class="liquid-btn" id="btnLogin" onclick="handleLogin()" style="width:100%;margin-top:10px"><span class="btn-text">Connect</span><div class="spinner"></div></button>
        <div class="login-error" id="loginError"></div>
    </div>
</div></div>

<!-- HOME -->
<div class="page" id="pg-home">
<div class="nav-bar">
    <div class="nav-left"><span class="nav-icon">ğŸ¤«</span><span class="nav-title gradient-text">Silent Signal</span></div>
    <div class="nav-right">
        <div class="nav-status"><span class="status-dot s-off" id="statusDot"></span><span id="statusText">connecting...</span></div>
        <div class="nav-avatar" id="navAvatar" onclick="handleLogout()">ğŸ‘¤</div>
    </div>
</div>
<div class="home-scroll">
    <div class="greeting-banner glass neon-border">
        <span class="greet-emoji" id="greetEmoji">ğŸŒ™</span>
        <div class="greeting-name" id="greetName"></div>
        <div class="greeting-date" id="greetDate"></div>
        <div class="greeting-tagline" id="greetTagline"></div>
    </div>
    <div class="quick-row">
        <div class="quick-btn" onclick="nav('pg-chat')">ğŸ’¬ quick chat</div>
        <div class="quick-btn" onclick="nav('pg-letters')">ğŸ’Œ write letter</div>
        <div class="quick-btn" onclick="nav('pg-confess')">ğŸ¤« confess</div>
        <div class="quick-btn" onclick="nav('pg-tod')">ğŸ¯ play T&D</div>
        <div class="quick-btn" onclick="nav('pg-music')">ğŸµ listen</div>
    </div>
    <div class="section-label">âŒ˜ our space</div>
    <div class="section-grid">
        <div class="section-card card-3d" onclick="nav('pg-chat')">
            <span class="card-icon">ğŸ’¬</span><span class="card-name">Chat</span><span class="card-sub">talk privately</span>
            <span class="unread-badge" id="chatBadge" style="display:none">0</span>
        </div>
        <div class="section-card card-3d" onclick="nav('pg-music')"><span class="card-icon">ğŸµ</span><span class="card-name">Music</span><span class="card-sub">our playlist</span></div>
        <div class="section-card card-3d" onclick="nav('pg-memories')"><span class="card-icon">ğŸ“¸</span><span class="card-name">Memories</span><span class="card-sub">our moments</span></div>
        <div class="section-card card-3d" onclick="nav('pg-memes')"><span class="card-icon">ğŸ˜‚</span><span class="card-name">Memes</span><span class="card-sub">laugh together</span></div>
        <div class="section-card card-3d" onclick="nav('pg-games')"><span class="card-icon">ğŸƒ</span><span class="card-name">Games</span><span class="card-sub">play together</span></div>
        <div class="section-card card-3d" onclick="nav('pg-tod')"><span class="card-icon">ğŸ¯</span><span class="card-name">Truth&Dare</span><span class="card-sub">how brave?</span></div>
        <div class="section-card card-3d" onclick="nav('pg-letters')"><span class="card-icon">ğŸ’Œ</span><span class="card-name">Letters</span><span class="card-sub">from the heart</span></div>
        <div class="section-card card-3d" onclick="nav('pg-confess')"><span class="card-icon">ğŸ¤«</span><span class="card-name">Confessions</span><span class="card-sub">speak freely</span></div>
        <div class="section-card card-3d" onclick="nav('pg-quotes')"><span class="card-icon">ğŸ’­</span><span class="card-name">Quotes</span><span class="card-sub">for us</span></div>
    </div>
    <div class="sync-section glass neon-border">
        <div class="sync-header"><span class="sync-label gradient-text">â™¡ Connection Sync</span><span class="sync-pct" id="syncPct">0%</span></div>
        <div class="sync-bar-bg"><div class="sync-bar" id="syncBar" style="width:0%"></div></div>
    </div>
    <div class="quote-section glass"><span class="quote-icon">âœ¦</span><div class="quote-text" id="dailyQuote"></div></div>
    <div class="home-ft">â™¡ our secret place â™¡</div>
</div></div>

<!-- â•â•â•â•â•â• CHAT â•â•â•â•â•â• -->
<div class="page" id="pg-chat">
    <div class="chat-header">
        <button class="btn-back" onclick="leaveChat()">â†</button>
        <div class="chat-hdr-info">
            <div class="chat-hdr-name" id="chatName">Partner</div>
            <div class="chat-hdr-status">
                <span class="status-dot s-off" id="chatStatusDot"></span>
                <span id="chatStatusText">offline</span>
            </div>
        </div>
        <div class="chat-hdr-avatar" id="chatAvatar">ğŸ‘¸</div>
    </div>
    <div class="chat-msgs" id="chatMsgs"></div>
    <div class="typing-wrap" id="typingWrap">
        <div class="typing-dots"><span></span><span></span><span></span></div>
        <span class="typing-label">typing...</span>
    </div>
    <div class="chat-input-area">
        <div class="chat-inp-wrap">
            <input type="text" class="chat-inp" id="chatInp" placeholder="type a message..." autocomplete="off">
        </div>
        <button class="chat-send disabled" id="chatSend" onclick="sendMsg()">â¤</button>
    </div>
</div>

<!-- SUB PAGES -->
<div class="page" id="pg-music"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸµ Music</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸµ</div><div class="ph-title">Music</div><div class="ph-sub">our songs, our vibes</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-memories"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸ“¸ Memories</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸ“¸</div><div class="ph-title">Memories</div><div class="ph-sub">every moment matters</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-memes"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸ˜‚ Memes</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸ˜‚</div><div class="ph-title">Memes</div><div class="ph-sub">laughing together forever</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-games"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸƒ Games</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸƒ</div><div class="ph-title">Games</div><div class="ph-sub">play together, stay together</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-tod"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸ¯ Truth & Dare</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸ¯</div><div class="ph-title">Truth or Dare</div><div class="ph-sub">how brave are you?</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-letters"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸ’Œ Letters</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸ’Œ</div><div class="ph-title">Love Letters</div><div class="ph-sub">words from the heart</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-confess"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸ¤« Confessions</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸ¤«</div><div class="ph-title">Confessions</div><div class="ph-sub">speak freely here</div><div class="ph-badge">coming soon</div></div></div></div>
<div class="page" id="pg-quotes"><div class="pg-header"><button class="btn-back" onclick="goBack()">â†</button><span class="pg-title gradient-text">ğŸ’­ Quotes</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">ğŸ’­</div><div class="ph-title">Quotes</div><div class="ph-sub">beautiful words for us</div><div class="ph-badge">coming soon</div></div></div></div>

<script src="/socket.io/socket.io.js"></script>
<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THE SILENT SIGNAL â€” ENGINE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var socket=null,currentUser=null,currentPage='pg-splash',pageHistory=[];
var chatMessages=[],chatLoaded=false,typingTimer=null,partnerOnline=false;

var quotes=["Every love story is beautiful, but ours is my favorite","In a sea of people, my eyes will always search for you","You are my today and all of my tomorrows","I fell in love the way you fall asleep: slowly, then all at once","You're the reason I look down at my phone and smile","My heart is and always will be yours","You are my sun, my moon, and all my stars","I love you more than yesterday, less than tomorrow","Together is my favorite place to be","Some hearts understand each other even in silence","I choose you. And I'll choose you over and over","You're my favorite notification","Every moment with you feels like magic","I want all of my lasts to be with you","You're the first and last thing on my mind each day"];
var days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
var months=['January','February','March','April','May','June','July','August','September','October','November','December'];

/* â•â•â• NAVIGATION â•â•â• */
function nav(id,anim,addHist){
    anim=anim||'anim-slide';if(addHist!==false)addHist=true;
    if(currentPage===id)return;
    var old=document.getElementById(currentPage),pg=document.getElementById(id);
    if(!pg)return;
    if(addHist)pageHistory.push(currentPage);
    old.classList.remove('active','anim-slide','anim-fade','anim-scale');
    pg.className='page active '+anim;currentPage=id;
    // Open chat handler
    if(id==='pg-chat')openChat();
}
function goBack(){
    if(!pageHistory.length)return;
    var prev=pageHistory.pop(),old=document.getElementById(currentPage),pg=document.getElementById(prev);
    old.classList.remove('active','anim-slide','anim-fade','anim-scale');
    pg.className='page active anim-fade';currentPage=prev;
}

/* â•â•â• LOGIN â•â•â• */
async function handleLogin(){
    var btn=document.getElementById('btnLogin'),err=document.getElementById('loginError');
    var u=document.getElementById('inpUser').value.trim(),p=document.getElementById('inpPass').value.trim();
    err.textContent='';
    if(!u||!p){err.textContent='âš  enter both fields';shakeCard();return}
    btn.classList.add('loading');
    try{
        var res=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});
        var data=await res.json();btn.classList.remove('loading');
        if(data.success){currentUser=data.user;localStorage.setItem('tss_user',JSON.stringify(data.user));setupHome();connectSocket();nav('pg-home','anim-scale')}
        else{err.textContent='âœ• '+data.message;shakeCard()}
    }catch(e){btn.classList.remove('loading');err.textContent='âš  signal lost...';shakeCard()}
}
function shakeCard(){var c=document.getElementById('loginCard');c.classList.add('shake');setTimeout(function(){c.classList.remove('shake')},500)}
document.addEventListener('keydown',function(e){if(e.key==='Enter'&&currentPage==='pg-login')handleLogin()});

function handleLogout(){
    if(confirm('Disconnect?')){
        localStorage.removeItem('tss_user');currentUser=null;chatMessages=[];chatLoaded=false;
        if(socket){socket.disconnect();socket=null}
        pageHistory=[];nav('pg-login','anim-fade',false);
    }
}

/* â•â•â• HOME â•â•â• */
function setupHome(){
    if(!currentUser)return;
    var now=new Date(),h=now.getHours();
    var g='Good Evening',e='ğŸŒ†';
    if(h<5){g='Sweet Dreams';e='ğŸŒ™'}else if(h<12){g='Good Morning';e='ğŸŒ…'}
    else if(h<17){g='Good Afternoon';e='â˜€ï¸'}else if(h<21){g='Good Evening';e='ğŸŒ†'}
    else{g='Good Night';e='ğŸŒ™'}
    document.getElementById('greetEmoji').textContent=e;
    document.getElementById('greetName').innerHTML=g+', <span>'+currentUser.displayName+'</span>';
    document.getElementById('greetDate').textContent=days[now.getDay()]+', '+now.getDate()+' '+months[now.getMonth()];
    document.getElementById('greetTagline').textContent='"some hearts understand each other in silence"';
    document.getElementById('navAvatar').textContent=currentUser.username==='cavity'?'ğŸ¤´':'ğŸ‘¸';
    document.getElementById('dailyQuote').textContent='"'+quotes[Math.floor(Math.random()*quotes.length)]+'"';
    setTimeout(function(){var p=Math.floor(Math.random()*12)+88;document.getElementById('syncPct').textContent=p+'%';document.getElementById('syncBar').style.width=p+'%'},800);
    checkUnread();
}

/* â•â•â• SOCKET â•â•â• */
function connectSocket(){
    if(socket)return;socket=io();
    socket.on('connect',function(){if(currentUser)socket.emit('user-online',currentUser.username)});

    socket.on('online-status',function(users){
        var partner=getPartner();
        partnerOnline=users.indexOf(partner)!==-1;
        // Nav bar
        document.getElementById('statusDot').className='status-dot '+(partnerOnline?'s-on':'s-off');
        document.getElementById('statusText').textContent=partnerOnline?'partner online':'partner away';
        // Chat header
        var cd=document.getElementById('chatStatusDot'),ct=document.getElementById('chatStatusText');
        if(cd){cd.className='status-dot '+(partnerOnline?'s-on':'s-off');ct.textContent=partnerOnline?'online':'offline'}
    });

    // Chat events
    socket.on('receive-message',function(msg){
        chatMessages.push(msg);
        if(currentPage==='pg-chat'){appendMsg(msg);scrollChat();markRead()}
        else{checkUnread();playNotif()}
    });
    socket.on('message-sent',function(msg){
        chatMessages.push(msg);
        if(currentPage==='pg-chat'){appendMsg(msg);scrollChat()}
    });
    socket.on('partner-typing',function(v){
        var el=document.getElementById('typingWrap');
        if(v){el.classList.add('show');scrollChat()}else{el.classList.remove('show')}
    });
    socket.on('partner-read',function(){
        document.querySelectorAll('.msg-check').forEach(function(c){c.classList.add('read')});
    });
}

function getPartner(){return currentUser.username==='cavity'?'cingam':'cavity'}
function getPartnerName(){return getPartner()==='cavity'?'Cavity':'Cingam'}

/* â•â•â• CHAT â•â•â• */
function openChat(){
    var partner=getPartner();
    document.getElementById('chatName').textContent=getPartnerName();
    document.getElementById('chatAvatar').textContent=partner==='cavity'?'ğŸ¤´':'ğŸ‘¸';
    document.getElementById('chatStatusDot').className='status-dot '+(partnerOnline?'s-on':'s-off');
    document.getElementById('chatStatusText').textContent=partnerOnline?'online':'offline';
    if(!chatLoaded)loadChatHistory();
    else{renderChat();markRead()}
    // Input setup
    var inp=document.getElementById('chatInp');
    inp.value='';
    inp.addEventListener('input',handleTyping);
    inp.addEventListener('keydown',function(e){if(e.key==='Enter')sendMsg()});
    updateSendBtn();
}

function leaveChat(){
    var partner=getPartner();
    if(socket)socket.emit('stop-typing',{receiver:partner});
    goBack();
}

async function loadChatHistory(){
    var container=document.getElementById('chatMsgs');
    container.innerHTML='<div style="display:flex;align-items:center;justify-content:center;height:100%"><div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div></div>';
    try{
        var res=await fetch('/api/messages');
        var data=await res.json();
        if(data.success){chatMessages=data.messages;chatLoaded=true;renderChat();markRead()}
    }catch(e){container.innerHTML='<div class="chat-empty"><div class="chat-empty-text">connection failed</div><div class="chat-empty-sub">pull to retry</div></div>'}
}

function renderChat(){
    var container=document.getElementById('chatMsgs');
    container.innerHTML='';
    if(chatMessages.length===0){
        container.innerHTML='<div class="chat-empty"><div class="chat-empty-icon">ğŸ’¬</div><div class="chat-empty-text">No messages yet</div><div class="chat-empty-sub">say something sweet...</div></div>';
        return;
    }
    var lastDate='';
    chatMessages.forEach(function(msg){
        var d=new Date(msg.timestamp),ds=fmtDate(d);
        if(ds!==lastDate){addDateSep(container,ds);lastDate=ds}
        addMsgEl(container,msg,false);
    });
    scrollChat();
}

function appendMsg(msg){
    var container=document.getElementById('chatMsgs');
    // Remove empty state
    var empty=container.querySelector('.chat-empty');
    if(empty)empty.remove();
    // Date sep check
    var d=new Date(msg.timestamp),ds=fmtDate(d);
    var seps=container.querySelectorAll('.msg-date-sep');
    var lastSep=seps.length>0?seps[seps.length-1].textContent.trim():'';
    if(ds!==lastSep)addDateSep(container,ds);
    addMsgEl(container,msg,true);
}

function addDateSep(container,dateStr){
    var sep=document.createElement('div');
    sep.className='msg-date-sep';
    sep.innerHTML='<span>'+dateStr+'</span>';
    container.appendChild(sep);
}

function addMsgEl(container,msg,animate){
    var isSent=msg.sender===currentUser.username;
    var row=document.createElement('div');
    row.className='msg-row '+(isSent?'sent':'received');
    if(!animate)row.style.animation='none';
    var t=new Date(msg.timestamp);
    var time=pad(t.getHours())+':'+pad(t.getMinutes());
    var check=isSent?'<span class="msg-check'+(msg.read?' read':'')+'">âœ“âœ“</span>':'';
    row.innerHTML='<div class="msg-bubble"><div class="msg-text">'+escHtml(msg.message)+'</div><div class="msg-time">'+time+' '+check+'</div></div>';
    container.appendChild(row);
}

function scrollChat(){
    var c=document.getElementById('chatMsgs');
    setTimeout(function(){c.scrollTop=c.scrollHeight},60);
}

function sendMsg(){
    var inp=document.getElementById('chatInp');
    var txt=inp.value.trim();
    if(!txt||!currentUser||!socket)return;
    socket.emit('send-message',{sender:currentUser.username,receiver:getPartner(),message:txt});
    inp.value='';updateSendBtn();
    socket.emit('stop-typing',{receiver:getPartner()});
}

function handleTyping(){
    updateSendBtn();
    if(!socket)return;
    var partner=getPartner();
    socket.emit('typing',{receiver:partner});
    clearTimeout(typingTimer);
    typingTimer=setTimeout(function(){socket.emit('stop-typing',{receiver:partner})},2000);
}

function updateSendBtn(){
    var btn=document.getElementById('chatSend');
    var inp=document.getElementById('chatInp');
    if(inp.value.trim().length>0)btn.classList.remove('disabled');
    else btn.classList.add('disabled');
}

async function markRead(){
    if(!currentUser)return;
    try{
        await fetch('/api/messages/read',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:currentUser.username})});
        if(socket)socket.emit('messages-read',{sender:getPartner()});
        updateBadge(0);
    }catch(e){}
}

async function checkUnread(){
    if(!currentUser)return;
    try{
        var res=await fetch('/api/unread/'+currentUser.username);
        var data=await res.json();
        if(data.success)updateBadge(data.count);
    }catch(e){}
}

function updateBadge(count){
    var b=document.getElementById('chatBadge');
    if(count>0){b.textContent=count>9?'9+':count;b.style.display='flex'}
    else{b.style.display='none'}
}

/* â•â•â• NOTIF SOUND â•â•â• */
function playNotif(){
    try{
        var ctx=new(window.AudioContext||window.webkitAudioContext)();
        var o=ctx.createOscillator(),g=ctx.createGain();
        o.connect(g);g.connect(ctx.destination);
        o.frequency.value=880;o.type='sine';
        g.gain.setValueAtTime(0.08,ctx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.4);
        o.start(ctx.currentTime);o.stop(ctx.currentTime+0.4);
        // Second tone
        var o2=ctx.createOscillator(),g2=ctx.createGain();
        o2.connect(g2);g2.connect(ctx.destination);
        o2.frequency.value=1100;o2.type='sine';
        g2.gain.setValueAtTime(0.06,ctx.currentTime+0.15);
        g2.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.5);
        o2.start(ctx.currentTime+0.15);o2.stop(ctx.currentTime+0.5);
    }catch(e){}
}

/* â•â•â• HELPERS â•â•â• */
function fmtDate(d){
    var today=new Date(),y=new Date(today);y.setDate(y.getDate()-1);
    if(d.toDateString()===today.toDateString())return'Today';
    if(d.toDateString()===y.toDateString())return'Yesterday';
    return d.getDate()+' '+months[d.getMonth()];
}
function pad(n){return n<10?'0'+n:''+n}
function escHtml(t){var d=document.createElement('div');d.textContent=t;return d.innerHTML}

/* â•â•â• PARTICLES â•â•â• */
function startPtc(){
    var c=document.getElementById('ptcBg');
    var h=['â™¡','â™¥','â¤','ğŸ’•','âœ¦','â‹†','âœ§','Â·','âº','Ëš'];
    function make(){
        var el=document.createElement('div'),r=Math.random();
        if(r<.3){el.className='ptc ptc-heart';el.textContent=h[Math.floor(Math.random()*4)];el.style.fontSize=(Math.random()*10+6)+'px'}
        else if(r<.6){el.className='ptc ptc-star';el.textContent=h[4+Math.floor(Math.random()*4)];el.style.fontSize=(Math.random()*8+4)+'px'}
        else if(r<.85){el.className='ptc ptc-dot';var s=Math.random()*2.5+1;el.style.width=s+'px';el.style.height=s+'px'}
        else{el.className='ptc ptc-sparkle';var s2=Math.random()*2+1;el.style.width=s2+'px';el.style.height=s2+'px'}
        el.style.left=Math.random()*100+'vw';
        el.style.animationDuration=(Math.random()*14+14)+'s';
        el.style.animationDelay=Math.random()*5+'s';
        c.appendChild(el);setTimeout(function(){el.remove()},32000);
    }
    for(var i=0;i<10;i++)setTimeout(make,i*250);
    setInterval(make,1800);
}

/* â•â•â• RIPPLE â•â•â• */
document.addEventListener('touchstart',function(e){
    var t=e.target.closest('.section-card,.liquid-btn,.btn-back,.quick-btn,.nav-avatar,.chat-send');
    if(!t)return;
    var r=t.getBoundingClientRect(),touch=e.touches[0],rip=document.createElement('div');
    rip.className='ripple';var size=Math.max(r.width,r.height)*2.5;
    rip.style.width=rip.style.height=size+'px';
    rip.style.left=(touch.clientX-r.left-size/2)+'px';
    rip.style.top=(touch.clientY-r.top-size/2)+'px';
    t.style.position=t.style.position||'relative';
    t.appendChild(rip);setTimeout(function(){rip.remove()},700);
},{passive:true});

/* â•â•â• INIT â•â•â• */
function init(){
    startPtc();
    var saved=localStorage.getItem('tss_user');
    setTimeout(function(){
        if(saved){try{currentUser=JSON.parse(saved);setupHome();connectSocket();nav('pg-home','anim-scale',false)}
        catch(e){localStorage.removeItem('tss_user');nav('pg-login','anim-fade',false)}}
        else{nav('pg-login','anim-fade',false)}
    },3000);
}
init();
</script>
</body>
</html>
