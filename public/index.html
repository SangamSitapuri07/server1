<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<title>The Silent Signal</title>
<style>
:root{--bg:#06040d;--card-bg:rgba(255,255,255,0.035);--border:rgba(255,255,255,0.06);--border-glow:rgba(255,20,147,0.5);--primary:#FF1493;--primary-rgb:255,20,147;--secondary:#FF4081;--secondary-rgb:255,64,129;--neon-pink:#FF10F0;--neon-purple:#B026FF;--neon-blue:#00D4FF;--soft-pink:#FF80AB;--deep-purple:#7B2FBE;--hot:#FF006E;--text:#fff;--text-dim:rgba(255,255,255,0.55);--text-muted:rgba(255,255,255,0.25);--font-display:'Orbitron',monospace;--font-body:'Space Grotesk',sans-serif;--font-accent:'Rajdhani',sans-serif}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{width:100%;height:100%;overflow:hidden;font-family:var(--font-body);background:var(--bg);color:var(--text);user-select:none}

.aurora{position:fixed;inset:0;z-index:0;background:radial-gradient(ellipse at 10% 20%,rgba(var(--primary-rgb),0.07) 0%,transparent 50%),radial-gradient(ellipse at 90% 80%,rgba(176,38,255,0.05) 0%,transparent 50%),radial-gradient(ellipse at 50% 0%,rgba(0,212,255,0.03) 0%,transparent 40%),var(--bg)}
.aurora-orb{position:absolute;border-radius:50%;filter:blur(80px);animation:aOD 20s ease-in-out infinite;mix-blend-mode:screen}
.ao1{width:50vw;height:50vw;top:-15%;left:-10%;background:radial-gradient(circle,rgba(var(--primary-rgb),0.12),transparent 70%);animation-duration:22s}
.ao2{width:45vw;height:45vw;bottom:-20%;right:-15%;background:radial-gradient(circle,rgba(176,38,255,0.1),transparent 70%);animation-duration:18s;animation-delay:-8s}
@keyframes aOD{0%,100%{transform:translate(0,0) scale(1);opacity:.5}25%{transform:translate(5%,-8%) scale(1.15);opacity:.7}50%{transform:translate(-3%,5%) scale(.9);opacity:.4}75%{transform:translate(4%,3%) scale(1.1);opacity:.6}}
.grid-ov{position:fixed;inset:0;z-index:1;pointer-events:none;background-image:linear-gradient(rgba(255,255,255,0.008) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.008) 1px,transparent 1px);background-size:50px 50px}

.particles{position:fixed;inset:0;z-index:3;pointer-events:none;overflow:hidden}
.ptc{position:absolute;opacity:0;animation:ptcR linear infinite}
.ptc-dot{border-radius:50%;background:rgba(var(--primary-rgb),0.4);box-shadow:0 0 6px rgba(var(--primary-rgb),0.3)}
.ptc-heart{filter:drop-shadow(0 0 4px rgba(var(--primary-rgb),0.4))}
.ptc-star{color:rgba(var(--primary-rgb),0.25)}
@keyframes ptcR{0%{transform:translateY(110vh) scale(0);opacity:0}4%{opacity:.6;transform:translateY(100vh) scale(1)}50%{opacity:.3}100%{transform:translateY(-5vh) scale(.3);opacity:0}}

.glass{background:rgba(255,255,255,0.03);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);border:1px solid rgba(255,255,255,0.06);box-shadow:0 8px 32px rgba(0,0,0,0.3)}
.neon-border{position:relative;overflow:hidden}
.neon-border::before{content:'';position:absolute;top:-1px;left:15%;right:15%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.5),rgba(176,38,255,0.3),transparent);animation:nS 4s ease-in-out infinite}
@keyframes nS{0%,100%{left:15%;right:15%;opacity:.5}50%{left:25%;right:25%;opacity:1}}
.breath-border{animation:bG 4s ease-in-out infinite}
@keyframes bG{0%,100%{border-color:rgba(255,255,255,0.04)}50%{border-color:rgba(var(--primary-rgb),0.15)}}

.shimmer-text{background:linear-gradient(120deg,rgba(255,255,255,.5) 0%,var(--primary) 20%,var(--neon-purple) 40%,var(--primary) 60%,rgba(255,255,255,.8) 75%,var(--primary) 100%);background-size:300% 100%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;animation:shim 6s linear infinite}
@keyframes shim{0%{background-position:300% 0}100%{background-position:-300% 0}}
.gradient-text{background:linear-gradient(135deg,var(--primary),var(--neon-purple),var(--primary));background-size:200% 200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;animation:gS 4s ease infinite}
@keyframes gS{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}

.liquid-btn{position:relative;overflow:hidden;border:none;border-radius:14px;padding:15px 30px;cursor:pointer;font-family:var(--font-display);font-size:12px;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:#fff;background:linear-gradient(135deg,var(--primary),var(--deep-purple),var(--hot),var(--primary));background-size:300% 300%;animation:lF 6s ease infinite;box-shadow:0 4px 15px rgba(var(--primary-rgb),0.3);transition:all .3s}
@keyframes lF{0%{background-position:0% 50%}25%{background-position:50% 0%}50%{background-position:100% 50%}75%{background-position:50% 100%}100%{background-position:0% 50%}}
.liquid-btn::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent 40%,rgba(255,255,255,0.05) 44%,rgba(255,255,255,0.15) 50%,rgba(255,255,255,0.05) 56%,transparent 60%);animation:lSh 4s infinite}
@keyframes lSh{0%{transform:translateX(-100%) rotate(25deg)}100%{transform:translateX(100%) rotate(25deg)}}
.liquid-btn:active{transform:scale(.95)}
.liquid-btn.loading{pointer-events:none;opacity:.7}
.liquid-btn.loading .btn-text{visibility:hidden}
.liquid-btn.loading .spinner{position:absolute;top:50%;left:50%;margin:-10px 0 0 -10px;width:20px;height:20px;border:2px solid rgba(255,255,255,.2);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

.page{position:fixed;inset:0;display:none;flex-direction:column;z-index:10;overflow:hidden}
.page.active{display:flex}
.page.anim-slide{animation:pgSl .4s cubic-bezier(.16,1,.3,1)}
.page.anim-fade{animation:pgFa .35s ease}
.page.anim-scale{animation:pgSc .45s cubic-bezier(.16,1,.3,1)}
@keyframes pgSl{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes pgFa{from{opacity:0}to{opacity:1}}
@keyframes pgSc{from{transform:scale(.92);opacity:0;filter:blur(5px)}to{transform:scale(1);opacity:1;filter:blur(0)}}

/* SPLASH */
#pg-splash{justify-content:center;align-items:center;background:radial-gradient(ellipse at 50% 40%,rgba(var(--primary-rgb),0.06),var(--bg) 70%)}
.sp-wrap{text-align:center;position:relative}
.sp-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,rgba(var(--primary-rgb),0.1),transparent 70%);animation:spGP 3s ease-in-out infinite}
@keyframes spGP{0%,100%{transform:translate(-50%,-50%) scale(1);opacity:.4}50%{transform:translate(-50%,-50%) scale(1.5);opacity:.8}}
.sp-pulse{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}
.sp-ring{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:80px;height:80px;border-radius:50%;border:1px solid rgba(var(--primary-rgb),0.12);animation:spRE 3.5s ease-out infinite}
.sp-ring:nth-child(2){animation-delay:1.2s}.sp-ring:nth-child(3){animation-delay:2.4s;width:60px;height:60px}
@keyframes spRE{0%{transform:translate(-50%,-50%) scale(.5);opacity:.7}100%{transform:translate(-50%,-50%) scale(4);opacity:0}}
.sp-icon{font-size:64px;position:relative;z-index:2;animation:spHB 1.8s ease-in-out infinite;filter:drop-shadow(0 0 25px rgba(var(--primary-rgb),0.4))}
@keyframes spHB{0%,100%{transform:scale(1)}15%{transform:scale(1.15)}30%{transform:scale(1)}45%{transform:scale(1.1)}}
.sp-brand{margin-top:30px;font-family:var(--font-display);font-size:15px;font-weight:800;letter-spacing:7px;text-transform:uppercase;animation:fU .8s ease .5s both}
.sp-line{width:50px;height:1px;margin:16px auto;background:linear-gradient(90deg,transparent,var(--primary),var(--neon-purple),transparent);animation:fU .8s ease .8s both}
.sp-sub{font-family:var(--font-accent);font-size:12px;color:var(--text-muted);letter-spacing:4px;text-transform:uppercase;animation:fU .8s ease 1.1s both}
@keyframes fU{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
.sp-loader{display:flex;gap:8px;justify-content:center;margin-top:45px;animation:fU .8s ease 1.4s both}
.sp-ldot{width:6px;height:6px;border-radius:50%;background:var(--primary);box-shadow:0 0 10px rgba(var(--primary-rgb),0.5);animation:spDP 1.6s ease-in-out infinite}
.sp-ldot:nth-child(2){animation-delay:.2s}.sp-ldot:nth-child(3){animation-delay:.4s}
@keyframes spDP{0%,100%{opacity:.2;transform:scale(.7)}50%{opacity:1;transform:scale(1.4)}}

/* LOGIN */
#pg-login{justify-content:center;align-items:center;padding:24px}
.login-card{width:100%;max-width:360px;padding:40px 26px;border-radius:24px;text-align:center;position:relative;animation:pgSc .5s cubic-bezier(.16,1,.3,1)}
.login-icon{font-size:44px;margin-bottom:10px;animation:lFl 4s ease-in-out infinite;filter:drop-shadow(0 0 20px rgba(var(--primary-rgb),0.3))}
@keyframes lFl{0%,100%{transform:translateY(0)}25%{transform:translateY(-8px) rotate(3deg)}75%{transform:translateY(-4px) rotate(-2deg)}}
.login-title{font-family:var(--font-display);font-size:13px;font-weight:700;letter-spacing:4px;text-transform:uppercase}
.login-sub{font-family:var(--font-accent);font-size:13px;color:var(--text-muted);margin:6px 0 30px;letter-spacing:1px}
.inp-group{position:relative;margin-bottom:16px;text-align:left}
.inp-label{font-family:var(--font-display);font-size:8px;font-weight:500;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase;margin-bottom:8px;display:block}
.inp{width:100%;padding:14px 16px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,0.02);color:#fff;font-family:var(--font-body);font-size:14px;outline:none;transition:all .4s}
.inp:focus{border-color:rgba(var(--primary-rgb),0.4);background:rgba(255,255,255,0.04);box-shadow:0 0 0 3px rgba(var(--primary-rgb),0.06)}
.inp::placeholder{color:rgba(255,255,255,0.12)}
textarea.inp{resize:none;min-height:100px;line-height:1.6}
.login-error{font-family:var(--font-accent);color:var(--soft-pink);font-size:12px;margin-top:14px;min-height:18px}
.shake{animation:shk .5s cubic-bezier(.36,.07,.19,.97)}
@keyframes shk{10%,90%{transform:translateX(-3px)}20%,80%{transform:translateX(5px)}30%,50%,70%{transform:translateX(-7px)}40%,60%{transform:translateX(7px)}}

/* NAV */
.nav-bar{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;padding-top:max(14px,env(safe-area-inset-top));border-bottom:1px solid var(--border);background:rgba(6,4,13,0.85);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);z-index:5;position:relative}
.nav-bar::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.15),transparent)}
.nav-left{display:flex;align-items:center;gap:10px}
.nav-icon{font-size:18px;filter:drop-shadow(0 0 8px rgba(var(--primary-rgb),0.4))}
.nav-title{font-family:var(--font-display);font-size:10px;font-weight:600;letter-spacing:2px;text-transform:uppercase}
.nav-right{display:flex;align-items:center;gap:14px}
.nav-status{display:flex;align-items:center;gap:5px;font-family:var(--font-accent);font-size:11px;color:var(--text-dim)}
.status-dot{width:7px;height:7px;border-radius:50%;box-shadow:0 0 10px currentColor;animation:stP 2s ease-in-out infinite}
@keyframes stP{0%,100%{box-shadow:0 0 5px currentColor}50%{box-shadow:0 0 15px currentColor,0 0 25px currentColor}}
.s-on{background:#4ADE80;color:#4ADE80}.s-off{background:#FF6B9D;color:#FF6B9D}
.nav-avatar{width:34px;height:34px;border-radius:10px;background:var(--card-bg);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer;transition:all .3s}
.nav-avatar:active{transform:scale(.88);border-color:var(--border-glow)}

/* PG HEADER */
.pg-header{display:flex;align-items:center;gap:14px;padding:14px 16px;padding-top:max(14px,env(safe-area-inset-top));border-bottom:1px solid var(--border);background:rgba(6,4,13,0.85);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);z-index:5;position:relative}
.pg-header::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.1),transparent)}
.btn-back{width:38px;height:38px;border-radius:10px;border:1px solid var(--border);background:var(--card-bg);color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .25s}
.btn-back:active{transform:scale(.85);border-color:var(--border-glow)}
.pg-title{font-family:var(--font-display);font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase;flex:1}
.pg-body{flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;padding:16px}
.pg-header-btn{padding:8px 16px;border-radius:50px;border:1px solid rgba(var(--primary-rgb),0.2);background:rgba(var(--primary-rgb),0.08);color:var(--soft-pink);font-family:var(--font-accent);font-size:12px;cursor:pointer;transition:all .3s}
.pg-header-btn:active{background:rgba(var(--primary-rgb),0.2);transform:scale(.95)}

/* HOME */
.home-scroll{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:40px}
.greeting-banner{margin:20px 16px;padding:26px 20px;border-radius:22px;text-align:center;position:relative;overflow:hidden;animation:pgSc .5s cubic-bezier(.16,1,.3,1);background:linear-gradient(135deg,rgba(var(--primary-rgb),0.06),rgba(176,38,255,0.03))}
.greeting-banner::before{content:'';position:absolute;top:0;left:15%;right:15%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.3),transparent)}
.greet-emoji{font-size:40px;display:block;margin-bottom:10px;animation:gFl 5s ease-in-out infinite}
@keyframes gFl{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.greeting-name{font-family:var(--font-display);font-size:16px;font-weight:700}
.greeting-name span{color:var(--primary);text-shadow:0 0 20px rgba(var(--primary-rgb),0.3)}
.greeting-date{font-family:var(--font-accent);color:var(--soft-pink);font-size:14px;margin-top:6px}
.greeting-tagline{font-family:var(--font-accent);color:rgba(255,128,171,0.35);font-size:12px;margin-top:4px;font-style:italic}
.quick-row{display:flex;gap:10px;padding:0 16px;margin:18px 0;overflow-x:auto;scrollbar-width:none}
.quick-row::-webkit-scrollbar{display:none}
.quick-btn{flex-shrink:0;padding:10px 20px;border-radius:50px;border:1px solid var(--border);background:var(--card-bg);color:var(--soft-pink);font-family:var(--font-accent);font-size:13px;cursor:pointer;white-space:nowrap;transition:all .3s}
.quick-btn:active{background:rgba(var(--primary-rgb),0.1);border-color:rgba(var(--primary-rgb),0.3);color:#fff;transform:scale(.96)}
.section-label{font-family:var(--font-display);font-size:9px;font-weight:600;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;padding:0 16px;margin:22px 0 16px}
.section-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:0 16px;perspective:600px}
.section-card{background:var(--card-bg);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:18px;padding:20px 10px;text-align:center;cursor:pointer;position:relative;overflow:hidden;transition:all .35s cubic-bezier(.4,0,.2,1)}
.section-card::before{content:'';position:absolute;top:0;left:25%;right:25%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.2),transparent);opacity:0;transition:opacity .3s}
.section-card:active{transform:scale(.95) rotateX(3deg);border-color:rgba(var(--primary-rgb),0.25);box-shadow:0 0 20px rgba(var(--primary-rgb),0.1)}
.section-card:active::before{opacity:1}
.card-icon{font-size:30px;display:block;margin-bottom:8px;transition:all .35s}
.section-card:active .card-icon{transform:scale(1.2) rotate(8deg)}
.card-name{font-family:var(--font-display);font-size:8px;font-weight:600;color:rgba(255,255,255,0.85);letter-spacing:1.5px;text-transform:uppercase}
.card-sub{font-family:var(--font-accent);font-size:10px;color:var(--soft-pink);margin-top:3px;display:block;opacity:.5}
.section-card{opacity:0;animation:cR .5s cubic-bezier(.16,1,.3,1) forwards}
.section-card:nth-child(1){animation-delay:.04s}.section-card:nth-child(2){animation-delay:.08s}.section-card:nth-child(3){animation-delay:.12s}
.section-card:nth-child(4){animation-delay:.18s}.section-card:nth-child(5){animation-delay:.24s}.section-card:nth-child(6){animation-delay:.30s}
.section-card:nth-child(7){animation-delay:.36s}.section-card:nth-child(8){animation-delay:.42s}.section-card:nth-child(9){animation-delay:.48s}
@keyframes cR{from{opacity:0;transform:translateY(20px) scale(.92)}to{opacity:1;transform:translateY(0) scale(1)}}
.unread-badge{position:absolute;top:8px;right:8px;min-width:18px;height:18px;border-radius:50%;background:var(--primary);color:#fff;font-family:var(--font-display);font-size:7px;font-weight:700;display:flex;align-items:center;justify-content:center;box-shadow:0 0 10px rgba(var(--primary-rgb),0.5);animation:bP 2s ease-in-out infinite;padding:0 4px}
@keyframes bP{0%,100%{box-shadow:0 0 5px rgba(var(--primary-rgb),.3)}50%{box-shadow:0 0 15px rgba(var(--primary-rgb),.6)}}
.sync-section{margin:24px 16px 0;padding:20px;border-radius:18px;position:relative;overflow:hidden}
.sync-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.sync-label{font-family:var(--font-display);font-size:9px;font-weight:600;letter-spacing:2px;text-transform:uppercase}
.sync-pct{font-family:var(--font-accent);font-size:20px;font-weight:700;color:var(--secondary)}
.sync-bar-bg{width:100%;height:4px;border-radius:4px;background:rgba(255,255,255,0.03);overflow:hidden}
.sync-bar{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--primary),var(--neon-purple),var(--secondary));background-size:200% 100%;box-shadow:0 0 12px rgba(var(--primary-rgb),0.3);animation:sG 3s ease-in-out infinite;transition:width 1.8s}
@keyframes sG{0%,100%{box-shadow:0 0 8px rgba(var(--primary-rgb),.2)}50%{box-shadow:0 0 18px rgba(var(--primary-rgb),.5)}}
.quote-section{margin:16px 16px 0;padding:18px 20px;border-radius:18px;text-align:center}
.quote-icon{font-size:14px;display:block;margin-bottom:8px;opacity:.4}
.quote-text{font-family:var(--font-accent);font-size:13px;color:rgba(255,128,171,0.4);line-height:1.7;font-style:italic}
.home-ft{text-align:center;padding:35px 0 15px;font-family:var(--font-accent);font-size:10px;color:rgba(255,255,255,0.06);letter-spacing:3px}

/* CHAT */
.chat-header{display:flex;align-items:center;gap:12px;padding:12px 16px;padding-top:max(12px,env(safe-area-inset-top));border-bottom:1px solid var(--border);background:rgba(6,4,13,0.9);backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);z-index:5}
.chat-hdr-info{flex:1}.chat-hdr-name{font-family:var(--font-display);font-size:12px;font-weight:600;letter-spacing:1.5px;text-transform:uppercase}
.chat-hdr-status{display:flex;align-items:center;gap:5px;font-family:var(--font-accent);font-size:11px;color:var(--text-dim);margin-top:2px}
.chat-hdr-avatar{width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,rgba(var(--primary-rgb),0.1),rgba(176,38,255,0.08));border:1px solid rgba(var(--primary-rgb),0.15);display:flex;align-items:center;justify-content:center;font-size:20px}
.chat-msgs{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:16px;display:flex;flex-direction:column;gap:6px}
.chat-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;opacity:.5}
.chat-empty-icon{font-size:60px;margin-bottom:14px;animation:gFl 3s ease-in-out infinite}
.chat-empty-text{font-family:var(--font-display);font-size:12px;letter-spacing:2px;color:var(--text-muted);text-transform:uppercase}
.chat-empty-sub{font-family:var(--font-accent);font-size:13px;color:rgba(var(--primary-rgb),0.3);margin-top:4px}
.msg-date-sep{text-align:center;padding:12px 0 8px;position:relative}
.msg-date-sep span{font-family:var(--font-display);font-size:8px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text-muted);background:var(--bg);padding:0 14px;position:relative;z-index:1}
.msg-date-sep::before{content:'';position:absolute;top:50%;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}
.msg-row{display:flex;max-width:82%;animation:mI .3s cubic-bezier(.16,1,.3,1)}
.msg-row.sent{align-self:flex-end}.msg-row.received{align-self:flex-start}
@keyframes mI{from{opacity:0;transform:translateY(12px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}
.msg-bubble{padding:10px 14px;border-radius:18px;font-size:14px;line-height:1.55;word-wrap:break-word;position:relative}
.sent .msg-bubble{background:linear-gradient(135deg,rgba(var(--primary-rgb),0.18),rgba(176,38,255,0.12));border:1px solid rgba(var(--primary-rgb),0.12);border-bottom-right-radius:6px}
.received .msg-bubble{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.05);border-bottom-left-radius:6px}
.msg-text{font-family:var(--font-body);font-size:13.5px}.msg-time{font-family:var(--font-accent);font-size:10px;color:rgba(255,255,255,0.2);margin-top:4px;display:flex;align-items:center;gap:4px}
.sent .msg-time{justify-content:flex-end}
.msg-check{font-size:10px;color:rgba(var(--primary-rgb),0.4)}.msg-check.read{color:rgba(var(--primary-rgb),0.8)}
.typing-wrap{padding:4px 16px 8px;display:none;align-items:center;gap:8px}
.typing-wrap.show{display:flex}
.typing-dots{display:flex;gap:3px;padding:8px 12px;background:rgba(255,255,255,0.04);border-radius:18px}
.typing-dots span{width:6px;height:6px;border-radius:50%;background:var(--primary);opacity:.3;animation:tD 1.4s ease-in-out infinite}
.typing-dots span:nth-child(2){animation-delay:.2s}.typing-dots span:nth-child(3){animation-delay:.4s}
@keyframes tD{0%,100%{opacity:.2;transform:scale(.7)}50%{opacity:.8;transform:scale(1.2)}}
.typing-label{font-family:var(--font-accent);font-size:11px;color:var(--text-muted)}
.chat-input-area{display:flex;align-items:flex-end;gap:10px;padding:12px 16px;padding-bottom:max(12px,env(safe-area-inset-bottom));border-top:1px solid var(--border);background:rgba(6,4,13,0.9);backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px)}
.chat-inp{width:100%;padding:12px 18px;border-radius:24px;border:1px solid var(--border);background:rgba(255,255,255,0.025);color:#fff;font-family:var(--font-body);font-size:14px;outline:none;transition:all .3s}
.chat-inp:focus{border-color:rgba(var(--primary-rgb),0.25);background:rgba(255,255,255,0.04)}
.chat-inp::placeholder{color:rgba(255,255,255,0.12)}
.chat-send{width:44px;height:44px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;transition:all .3s;background:linear-gradient(135deg,var(--primary),var(--deep-purple));color:#fff;box-shadow:0 4px 15px rgba(var(--primary-rgb),0.25);flex-shrink:0}
.chat-send:active{transform:scale(.88)}.chat-send.disabled{opacity:.3;pointer-events:none}

/* ‚ïê‚ïê‚ïê LETTERS ‚ïê‚ïê‚ïê */
.letters-tabs{display:flex;gap:0;border-bottom:1px solid var(--border);background:rgba(6,4,13,0.5)}
.l-tab{flex:1;padding:12px;text-align:center;font-family:var(--font-display);font-size:9px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text-muted);cursor:pointer;transition:all .3s;position:relative}
.l-tab.active{color:var(--primary)}
.l-tab.active::after{content:'';position:absolute;bottom:-1px;left:20%;right:20%;height:2px;background:var(--primary);box-shadow:0 0 10px rgba(var(--primary-rgb),0.5);border-radius:2px}
.l-tab:active{background:rgba(var(--primary-rgb),0.05)}
.letter-list{padding:16px;display:flex;flex-direction:column;gap:12px}
.letter-item{border-radius:18px;padding:18px;cursor:pointer;transition:all .3s;position:relative;overflow:hidden;animation:cR .4s ease forwards;opacity:0}
.letter-item::before{content:'';position:absolute;top:0;left:20%;right:20%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.15),transparent)}
.letter-item:active{transform:scale(.98);border-color:rgba(var(--primary-rgb),0.2)}
.letter-item.unread{border-color:rgba(var(--primary-rgb),0.15);box-shadow:0 0 15px rgba(var(--primary-rgb),0.05)}
.letter-mood{font-size:28px;float:left;margin-right:12px;margin-top:2px;animation:gFl 3s ease-in-out infinite}
.letter-title{font-family:var(--font-display);font-size:11px;font-weight:600;letter-spacing:1px;color:#fff;text-transform:uppercase}
.letter-preview{font-family:var(--font-accent);font-size:13px;color:var(--text-dim);margin-top:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:80%}
.letter-meta{font-family:var(--font-accent);font-size:10px;color:var(--text-muted);margin-top:6px}
.letter-new-dot{position:absolute;top:18px;right:18px;width:8px;height:8px;border-radius:50%;background:var(--primary);box-shadow:0 0 10px rgba(var(--primary-rgb),0.5);animation:bP 2s infinite}
.letter-empty{text-align:center;padding:60px 20px;color:var(--text-muted)}
.letter-empty-icon{font-size:50px;margin-bottom:12px;display:block;animation:gFl 3s ease-in-out infinite}
.letter-empty-text{font-family:var(--font-display);font-size:11px;letter-spacing:2px;text-transform:uppercase}

/* Write Letter */
.write-letter{padding:20px 16px}
.write-section{margin-bottom:20px}
.write-label{font-family:var(--font-display);font-size:8px;font-weight:500;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase;margin-bottom:10px;display:block}
.mood-picker{display:flex;gap:10px;flex-wrap:wrap}
.mood-opt{width:44px;height:44px;border-radius:12px;border:1px solid var(--border);background:var(--card-bg);display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;transition:all .3s}
.mood-opt.sel{border-color:rgba(var(--primary-rgb),0.4);background:rgba(var(--primary-rgb),0.1);box-shadow:0 0 15px rgba(var(--primary-rgb),0.1);transform:scale(1.1)}
.mood-opt:active{transform:scale(.9)}

/* Read Letter */
.read-letter{padding:24px 20px;text-align:center}
.read-letter-mood{font-size:50px;display:block;margin-bottom:16px;animation:gFl 3s ease-in-out infinite;filter:drop-shadow(0 0 15px rgba(var(--primary-rgb),0.3))}
.read-letter-title{font-family:var(--font-display);font-size:14px;font-weight:700;letter-spacing:2px;margin-bottom:6px;text-transform:uppercase}
.read-letter-from{font-family:var(--font-accent);font-size:12px;color:var(--soft-pink);margin-bottom:20px}
.read-letter-content{font-family:var(--font-body);font-size:15px;line-height:1.9;color:rgba(255,255,255,0.8);text-align:left;padding:20px;border-radius:18px;white-space:pre-wrap}
.read-letter-date{font-family:var(--font-accent);font-size:11px;color:var(--text-muted);margin-top:20px}

/* ‚ïê‚ïê‚ïê CONFESSIONS ‚ïê‚ïê‚ïê */
.conf-list{padding:16px;display:flex;flex-direction:column;gap:14px}
.conf-item{border-radius:18px;padding:18px;position:relative;overflow:hidden;animation:cR .4s ease forwards;opacity:0}
.conf-item::before{content:'';position:absolute;top:0;left:20%;right:20%;height:1px;background:linear-gradient(90deg,transparent,rgba(176,38,255,0.15),transparent)}
.conf-mood{font-size:24px;float:left;margin-right:10px}
.conf-content{font-family:var(--font-body);font-size:14px;line-height:1.7;color:rgba(255,255,255,0.75)}
.conf-footer{display:flex;align-items:center;justify-content:space-between;margin-top:12px;padding-top:10px;border-top:1px solid var(--border)}
.conf-meta{font-family:var(--font-accent);font-size:10px;color:var(--text-muted)}
.conf-heart-btn{display:flex;align-items:center;gap:5px;padding:6px 14px;border-radius:50px;border:1px solid var(--border);background:transparent;color:var(--text-muted);font-family:var(--font-accent);font-size:12px;cursor:pointer;transition:all .3s}
.conf-heart-btn.hearted{border-color:rgba(var(--primary-rgb),0.3);color:var(--primary);background:rgba(var(--primary-rgb),0.06)}
.conf-heart-btn:active{transform:scale(.9)}

/* Write Confession */
.write-conf{padding:20px 16px}
.conf-mood-row{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap}

/* ‚ïê‚ïê‚ïê TRUTH & DARE ‚ïê‚ïê‚ïê */
.tod-wrap{display:flex;flex-direction:column;align-items:center;padding:30px 20px;text-align:center}
.tod-card{width:100%;max-width:340px;border-radius:24px;padding:30px 24px;text-align:center;position:relative;overflow:hidden;min-height:200px;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .5s}
.tod-card::before{content:'';position:absolute;top:0;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.3),transparent)}
.tod-emoji{font-size:50px;margin-bottom:16px;animation:gFl 3s ease-in-out infinite}
.tod-type{font-family:var(--font-display);font-size:12px;font-weight:700;letter-spacing:3px;text-transform:uppercase;margin-bottom:14px}
.tod-type.truth{color:#4ADE80}.tod-type.dare{color:var(--primary)}
.tod-question{font-family:var(--font-body);font-size:16px;line-height:1.7;color:rgba(255,255,255,0.85);padding:0 10px}
.tod-category{font-family:var(--font-accent);font-size:11px;color:var(--text-muted);margin-top:14px;letter-spacing:1px}
.tod-btns{display:flex;gap:12px;margin-top:30px;width:100%;max-width:340px}
.tod-btn{flex:1;padding:14px;border-radius:14px;border:1px solid var(--border);background:var(--card-bg);color:#fff;font-family:var(--font-display);font-size:10px;font-weight:600;letter-spacing:2px;text-transform:uppercase;cursor:pointer;transition:all .3s;text-align:center}
.tod-btn:active{transform:scale(.95)}
.tod-btn.truth-btn:active{border-color:rgba(74,222,128,0.4);background:rgba(74,222,128,0.08);box-shadow:0 0 20px rgba(74,222,128,0.1)}
.tod-btn.dare-btn:active{border-color:rgba(var(--primary-rgb),0.4);background:rgba(var(--primary-rgb),0.08);box-shadow:0 0 20px rgba(var(--primary-rgb),0.1)}
.tod-btn.random-btn{background:linear-gradient(135deg,rgba(var(--primary-rgb),0.1),rgba(176,38,255,0.08));border-color:rgba(var(--primary-rgb),0.15)}
.tod-btn.random-btn:active{box-shadow:0 0 20px rgba(var(--primary-rgb),0.15)}
.tod-score{display:flex;gap:20px;margin-top:20px;font-family:var(--font-accent);font-size:13px;color:var(--text-dim)}
.tod-flip{animation:todFlip .5s ease}
@keyframes todFlip{0%{transform:rotateY(0) scale(1)}50%{transform:rotateY(90deg) scale(.9)}100%{transform:rotateY(0) scale(1)}}

/* ‚ïê‚ïê‚ïê QUOTES ‚ïê‚ïê‚ïê */
.quotes-list{padding:16px;display:flex;flex-direction:column;gap:14px}
.qt-item{border-radius:18px;padding:20px;position:relative;overflow:hidden;text-align:center;animation:cR .4s ease forwards;opacity:0}
.qt-item::before{content:'';position:absolute;top:0;left:20%;right:20%;height:1px;background:linear-gradient(90deg,transparent,rgba(var(--primary-rgb),0.12),transparent)}
.qt-mark{font-size:28px;display:block;margin-bottom:8px;opacity:.3;font-family:serif}
.qt-text{font-family:var(--font-body);font-size:15px;line-height:1.8;color:rgba(255,255,255,0.75);font-style:italic}
.qt-author{font-family:var(--font-accent);font-size:12px;color:var(--soft-pink);margin-top:10px;opacity:.6}
.qt-footer{display:flex;align-items:center;justify-content:center;margin-top:12px;gap:10px}
.qt-heart-btn{display:flex;align-items:center;gap:5px;padding:6px 14px;border-radius:50px;border:1px solid var(--border);background:transparent;color:var(--text-muted);font-family:var(--font-accent);font-size:12px;cursor:pointer;transition:all .3s}
.qt-heart-btn.hearted{border-color:rgba(var(--primary-rgb),0.3);color:var(--primary);background:rgba(var(--primary-rgb),0.06)}
.qt-heart-btn:active{transform:scale(.9)}
.qt-added{font-family:var(--font-accent);font-size:10px;color:var(--text-muted)}

/* PLACEHOLDER */
.ph-wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;height:70vh;text-align:center;padding:20px}
.ph-icon{font-size:64px;margin-bottom:18px;animation:gFl 3s ease-in-out infinite}
.ph-title{font-family:var(--font-display);font-size:13px;font-weight:700;color:rgba(255,255,255,.6);letter-spacing:3px;text-transform:uppercase}
.ph-sub{font-family:var(--font-accent);color:var(--text-muted);font-size:14px;margin-top:8px}
.ph-badge{margin-top:22px;padding:9px 22px;border-radius:50px;font-family:var(--font-display);font-size:8px;font-weight:600;color:var(--text-muted);letter-spacing:2px;text-transform:uppercase;border:1px solid var(--border);background:var(--card-bg)}

.ripple{position:absolute;border-radius:50%;background:radial-gradient(circle,rgba(var(--primary-rgb),0.2),transparent 70%);transform:scale(0);animation:ripO .7s ease-out;pointer-events:none}
@keyframes ripO{to{transform:scale(4);opacity:0}}
::-webkit-scrollbar{width:2px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:rgba(var(--primary-rgb),0.1);border-radius:10px}
@media(max-width:360px){.section-grid{gap:8px;padding:0 12px}.section-card{padding:14px 6px}.card-icon{font-size:22px}.greeting-name{font-size:14px}}
</style>
</head>
<body>

<div class="aurora"><div class="aurora-orb ao1"></div><div class="aurora-orb ao2"></div></div>
<div class="grid-ov"></div>
<div class="particles" id="ptcBg"></div>

<!-- SPLASH -->
<div class="page active" id="pg-splash">
<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%">
<div class="sp-wrap"><div class="sp-glow"></div><div class="sp-pulse"><div class="sp-ring"></div><div class="sp-ring"></div><div class="sp-ring"></div></div><div class="sp-icon">ü§´</div></div>
<div class="sp-brand shimmer-text">The Silent Signal</div><div class="sp-line"></div><div class="sp-sub">only for us</div>
<div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div>
</div></div>

<!-- LOGIN -->
<div class="page" id="pg-login">
<div style="flex:1;display:flex;align-items:center;justify-content:center;padding:24px">
<div class="login-card glass neon-border breath-border" id="loginCard">
<div class="login-icon">ü§´</div><div class="login-title shimmer-text">Silent Signal</div><div class="login-sub">enter your signal to connect</div>
<div class="inp-group"><label class="inp-label">Username</label><input class="inp" type="text" id="inpUser" placeholder="enter username" autocomplete="off" autocapitalize="off"></div>
<div class="inp-group"><label class="inp-label">Password</label><input class="inp" type="password" id="inpPass" placeholder="enter password"></div>
<button class="liquid-btn" id="btnLogin" onclick="handleLogin()" style="width:100%;margin-top:10px"><span class="btn-text">Connect</span><div class="spinner"></div></button>
<div class="login-error" id="loginError"></div>
</div></div></div>

<!-- HOME -->
<div class="page" id="pg-home">
<div class="nav-bar"><div class="nav-left"><span class="nav-icon">ü§´</span><span class="nav-title gradient-text">Silent Signal</span></div>
<div class="nav-right"><div class="nav-status"><span class="status-dot s-off" id="statusDot"></span><span id="statusText">connecting...</span></div>
<div class="nav-avatar" id="navAvatar" onclick="handleLogout()">üë§</div></div></div>
<div class="home-scroll">
<div class="greeting-banner glass neon-border"><span class="greet-emoji" id="greetEmoji">üåô</span><div class="greeting-name" id="greetName"></div><div class="greeting-date" id="greetDate"></div><div class="greeting-tagline" id="greetTagline"></div></div>
<div class="quick-row">
<div class="quick-btn" onclick="nav('pg-chat')">üí¨ chat</div>
<div class="quick-btn" onclick="nav('pg-letters')">üíå letter</div>
<div class="quick-btn" onclick="nav('pg-confess')">ü§´ confess</div>
<div class="quick-btn" onclick="nav('pg-tod')">üéØ T&D</div>
</div>
<div class="section-label">‚åò our space</div>
<div class="section-grid">
<div class="section-card" onclick="nav('pg-chat')"><span class="card-icon">üí¨</span><span class="card-name">Chat</span><span class="card-sub">talk</span><span class="unread-badge" id="chatBadge" style="display:none">0</span></div>
<div class="section-card" onclick="nav('pg-music')"><span class="card-icon">üéµ</span><span class="card-name">Music</span><span class="card-sub">listen</span></div>
<div class="section-card" onclick="nav('pg-memories')"><span class="card-icon">üì∏</span><span class="card-name">Memories</span><span class="card-sub">moments</span></div>
<div class="section-card" onclick="nav('pg-memes')"><span class="card-icon">üòÇ</span><span class="card-name">Memes</span><span class="card-sub">laugh</span></div>
<div class="section-card" onclick="nav('pg-games')"><span class="card-icon">üÉè</span><span class="card-name">Games</span><span class="card-sub">play</span></div>
<div class="section-card" onclick="nav('pg-tod')"><span class="card-icon">üéØ</span><span class="card-name">T&D</span><span class="card-sub">brave?</span></div>
<div class="section-card" onclick="nav('pg-letters')"><span class="card-icon">üíå</span><span class="card-name">Letters</span><span class="card-sub">heart</span><span class="unread-badge" id="letterBadge" style="display:none">0</span></div>
<div class="section-card" onclick="nav('pg-confess')"><span class="card-icon">ü§´</span><span class="card-name">Confess</span><span class="card-sub">freely</span></div>
<div class="section-card" onclick="nav('pg-quotes')"><span class="card-icon">üí≠</span><span class="card-name">Quotes</span><span class="card-sub">words</span></div>
</div>
<div class="sync-section glass neon-border"><div class="sync-header"><span class="sync-label gradient-text">‚ô° Sync</span><span class="sync-pct" id="syncPct">0%</span></div><div class="sync-bar-bg"><div class="sync-bar" id="syncBar" style="width:0%"></div></div></div>
<div class="quote-section glass"><span class="quote-icon">‚ú¶</span><div class="quote-text" id="dailyQuote"></div></div>
<div class="home-ft">‚ô° our secret place ‚ô°</div>
</div></div>

<!-- CHAT -->
<div class="page" id="pg-chat">
<div class="chat-header"><button class="btn-back" onclick="leaveChat()">‚Üê</button><div class="chat-hdr-info"><div class="chat-hdr-name" id="chatName">Partner</div><div class="chat-hdr-status"><span class="status-dot s-off" id="chatStatusDot"></span><span id="chatStatusText">offline</span></div></div><div class="chat-hdr-avatar" id="chatAvatar">üë∏</div></div>
<div class="chat-msgs" id="chatMsgs"></div>
<div class="typing-wrap" id="typingWrap"><div class="typing-dots"><span></span><span></span><span></span></div><span class="typing-label">typing...</span></div>
<div class="chat-input-area"><div style="flex:1"><input type="text" class="chat-inp" id="chatInp" placeholder="type a message..." autocomplete="off"></div><button class="chat-send disabled" id="chatSend" onclick="sendMsg()">‚û§</button></div>
</div>

<!-- LETTERS -->
<div class="page" id="pg-letters">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üíå Letters</span><button class="pg-header-btn" onclick="showWriteLetter()">‚úç Write</button></div>
<div class="letters-tabs"><div class="l-tab active" id="ltabInbox" onclick="switchLetterTab('inbox')">üì• Inbox</div><div class="l-tab" id="ltabSent" onclick="switchLetterTab('sent')">üì§ Sent</div></div>
<div class="pg-body" id="letterBody"><div class="letter-list" id="letterList"></div></div>
</div>

<!-- WRITE LETTER -->
<div class="page" id="pg-write-letter">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">‚úç Write Letter</span></div>
<div class="pg-body"><div class="write-letter">
<div class="write-section"><span class="write-label">Mood</span><div class="mood-picker" id="letterMoods"></div></div>
<div class="write-section"><span class="write-label">Title</span><input class="inp" type="text" id="letterTitle" placeholder="a title for your letter..." autocomplete="off"></div>
<div class="write-section"><span class="write-label">Your Letter</span><textarea class="inp" id="letterContent" placeholder="write from your heart..." style="min-height:180px"></textarea></div>
<button class="liquid-btn" style="width:100%" id="btnSendLetter" onclick="sendLetter()"><span class="btn-text">üíå Send Letter</span><div class="spinner"></div></button>
</div></div></div>

<!-- READ LETTER -->
<div class="page" id="pg-read-letter">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üíå Letter</span></div>
<div class="pg-body"><div class="read-letter" id="readLetterBody"></div></div>
</div>

<!-- CONFESSIONS -->
<div class="page" id="pg-confess">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">ü§´ Confessions</span><button class="pg-header-btn" onclick="showWriteConf()">‚úç Write</button></div>
<div class="pg-body" id="confBody"><div class="conf-list" id="confList"></div></div>
</div>

<!-- WRITE CONFESSION -->
<div class="page" id="pg-write-conf">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">‚úç Confession</span></div>
<div class="pg-body"><div class="write-conf">
<div class="write-section"><span class="write-label">Mood</span><div class="mood-picker" id="confMoods"></div></div>
<div class="write-section"><span class="write-label">Your Confession</span><textarea class="inp" id="confContent" placeholder="say what's in your heart..." style="min-height:180px"></textarea></div>
<button class="liquid-btn" style="width:100%" id="btnPostConf" onclick="postConf()"><span class="btn-text">ü§´ Post Confession</span><div class="spinner"></div></button>
</div></div></div>

<!-- TRUTH & DARE -->
<div class="page" id="pg-tod">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üéØ Truth & Dare</span></div>
<div class="pg-body">
<div class="tod-wrap">
<div class="tod-card glass neon-border" id="todCard">
<div class="tod-emoji" id="todEmoji">üéØ</div>
<div class="tod-type" id="todType">Ready?</div>
<div class="tod-question" id="todQ">Choose Truth, Dare, or let fate decide!</div>
<div class="tod-category" id="todCat"></div>
</div>
<div class="tod-btns">
<button class="tod-btn truth-btn" onclick="getTod('truth')">üü¢ Truth</button>
<button class="tod-btn random-btn" onclick="getTod('random')">üé≤ Random</button>
<button class="tod-btn dare-btn" onclick="getTod('dare')">üî¥ Dare</button>
</div>
</div></div></div>

<!-- QUOTES -->
<div class="page" id="pg-quotes">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üí≠ Quotes</span><button class="pg-header-btn" onclick="showAddQuote()">+ Add</button></div>
<div class="pg-body" id="quotesBody"><div class="quotes-list" id="quotesList"></div></div>
</div>

<!-- ADD QUOTE -->
<div class="page" id="pg-add-quote">
<div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üí≠ Add Quote</span></div>
<div class="pg-body"><div class="write-conf">
<div class="write-section"><span class="write-label">Quote</span><textarea class="inp" id="newQuoteText" placeholder="a beautiful quote..." style="min-height:120px"></textarea></div>
<div class="write-section"><span class="write-label">Author (optional)</span><input class="inp" type="text" id="newQuoteAuthor" placeholder="who said it?" autocomplete="off"></div>
<button class="liquid-btn" style="width:100%" id="btnAddQuote" onclick="addQuote()"><span class="btn-text">üí≠ Add Quote</span><div class="spinner"></div></button>
</div></div></div>

<!-- OTHER PAGES -->
<div class="page" id="pg-music"><div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üéµ Music</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">üéµ</div><div class="ph-title">Music</div><div class="ph-sub">coming soon</div><div class="ph-badge">next update</div></div></div></div>
<div class="page" id="pg-memories"><div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üì∏ Memories</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">üì∏</div><div class="ph-title">Memories</div><div class="ph-sub">coming soon</div><div class="ph-badge">next update</div></div></div></div>
<div class="page" id="pg-memes"><div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üòÇ Memes</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">üòÇ</div><div class="ph-title">Memes</div><div class="ph-sub">coming soon</div><div class="ph-badge">next update</div></div></div></div>
<div class="page" id="pg-games"><div class="pg-header"><button class="btn-back" onclick="goBack()">‚Üê</button><span class="pg-title gradient-text">üÉè Games</span></div><div class="pg-body"><div class="ph-wrap"><div class="ph-icon">üÉè</div><div class="ph-title">Games</div><div class="ph-sub">coming soon</div><div class="ph-badge">next update</div></div></div></div>

<script src="/socket.io/socket.io.js"></script>
<script>
var socket=null,currentUser=null,currentPage='pg-splash',pageHistory=[];
var chatMessages=[],chatLoaded=false,typingTimer=null,partnerOnline=false;
var letterTab='inbox',selLetterMood='üíï',selConfMood='üí≠';

var days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
var months=['January','February','March','April','May','June','July','August','September','October','November','December'];
var homeQuotes=["Every love story is beautiful, but ours is my favorite","In a sea of people, my eyes will always search for you","You are my today and all of my tomorrows","Some hearts understand each other even in silence","I choose you. And I will choose you over and over"];

var moodOptions=['üíï','‚ù§Ô∏è','ü•∞','üî•','üåô','üíå','ü§´','üòò','üíã','ü¶ã','‚ú®','üí´'];

var truths=[
    {q:"What's one thing you've never told me but always wanted to?",c:"Deep"},
    {q:"What was your first impression of me?",c:"Memory"},
    {q:"What's your favorite memory of us together?",c:"Memory"},
    {q:"What do you love most about me?",c:"Love"},
    {q:"Have you ever dreamed about me? What happened?",c:"Dreams"},
    {q:"What song reminds you of us?",c:"Music"},
    {q:"What's something small I do that makes you really happy?",c:"Little Things"},
    {q:"If you could relive one moment with me, which would it be?",c:"Memory"},
    {q:"What were you thinking during our first conversation?",c:"Memory"},
    {q:"What's your favorite thing about my personality?",c:"Love"},
    {q:"What's one thing you want us to do together someday?",c:"Dreams"},
    {q:"When did you first realize you had feelings for me?",c:"Love"},
    {q:"What's the most romantic thing you've imagined us doing?",c:"Dreams"},
    {q:"What do you think makes us special as a couple?",c:"Love"},
    {q:"Have you ever written something about me and not shared it?",c:"Secret"},
    {q:"What's one fear you have about us?",c:"Deep"},
    {q:"What's the sweetest thing I've ever said to you?",c:"Memory"},
    {q:"If you could change one thing about our relationship, what?",c:"Deep"},
    {q:"What physical feature of mine do you find most attractive?",c:"Flirty"},
    {q:"What's something you pretend not to notice but actually love?",c:"Little Things"},
    {q:"Rate our first date from 1-10 and explain why",c:"Memory"},
    {q:"What do you miss most when we're apart?",c:"Love"},
    {q:"What nickname do you secretly want me to call you?",c:"Flirty"},
    {q:"What's one thing that always makes you smile about me?",c:"Love"},
    {q:"If we had a movie, what would the title be?",c:"Fun"}
];

var dares=[
    {q:"Send me the most romantic text you can think of right now",c:"Romantic"},
    {q:"Record a voice message saying 3 things you love about me",c:"Love"},
    {q:"Write me a 4-line poem right now",c:"Creative"},
    {q:"Send me your favorite photo of us with a sweet caption",c:"Memory"},
    {q:"Tell me something you've been holding back",c:"Deep"},
    {q:"Send a song that describes your feelings for me",c:"Music"},
    {q:"Give me 5 compliments in a row without stopping",c:"Love"},
    {q:"Describe our perfect date in detail",c:"Dreams"},
    {q:"Send me a goodnight message as if it's our last night on earth",c:"Romantic"},
    {q:"Make up a love story about us in 5 sentences",c:"Creative"},
    {q:"Send me a selfie with a heart drawn on your hand",c:"Fun"},
    {q:"Write 'I love you' in 3 different creative ways",c:"Creative"},
    {q:"Describe me to a stranger without using my name",c:"Love"},
    {q:"Plan our next date right now, every detail",c:"Dreams"},
    {q:"Send the last photo in your gallery",c:"Fun"},
    {q:"Change your profile picture to our photo for 24 hours",c:"Bold"},
    {q:"Write a short love letter to me right now in chat",c:"Romantic"},
    {q:"Tell me your top 3 moments with me",c:"Memory"},
    {q:"Describe how you feel about me using only emojis",c:"Fun"},
    {q:"Give me a new cute nickname and use it for a week",c:"Flirty"},
    {q:"Send me a voice note singing our song",c:"Bold"},
    {q:"Confess something sweet in the confession room",c:"Romantic"},
    {q:"Tell me what outfit of mine you like the most",c:"Flirty"},
    {q:"Describe your dream future with me",c:"Dreams"},
    {q:"Say the cheesiest pickup line you can think of",c:"Fun"}
];

/* ‚ïê‚ïê‚ïê NAVIGATION ‚ïê‚ïê‚ïê */
function nav(id,anim,addHist){
    anim=anim||'anim-slide';if(addHist!==false)addHist=true;
    if(currentPage===id)return;
    var old=document.getElementById(currentPage),pg=document.getElementById(id);
    if(!pg)return;if(addHist)pageHistory.push(currentPage);
    old.classList.remove('active','anim-slide','anim-fade','anim-scale');
    pg.className='page active '+anim;currentPage=id;
    if(id==='pg-chat')openChat();
    if(id==='pg-letters')loadLetters();
    if(id==='pg-confess')loadConf();
    if(id==='pg-quotes')loadQuotes();
}
function goBack(){if(!pageHistory.length)return;var p=pageHistory.pop(),o=document.getElementById(currentPage),n=document.getElementById(p);o.classList.remove('active','anim-slide','anim-fade','anim-scale');n.className='page active anim-fade';currentPage=p}

/* ‚ïê‚ïê‚ïê LOGIN ‚ïê‚ïê‚ïê */
async function handleLogin(){
    var btn=document.getElementById('btnLogin'),err=document.getElementById('loginError');
    var u=document.getElementById('inpUser').value.trim(),p=document.getElementById('inpPass').value.trim();
    err.textContent='';if(!u||!p){err.textContent='‚ö† enter both fields';shakeCard();return}
    btn.classList.add('loading');
    try{var r=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});var d=await r.json();btn.classList.remove('loading');
    if(d.success){currentUser=d.user;localStorage.setItem('tss_user',JSON.stringify(d.user));setupHome();connectSocket();nav('pg-home','anim-scale')}
    else{err.textContent='‚úï '+d.message;shakeCard()}}catch(e){btn.classList.remove('loading');err.textContent='‚ö† signal lost...';shakeCard()}
}
function shakeCard(){var c=document.getElementById('loginCard');c.classList.add('shake');setTimeout(function(){c.classList.remove('shake')},500)}
document.addEventListener('keydown',function(e){if(e.key==='Enter'&&currentPage==='pg-login')handleLogin()});
function handleLogout(){if(confirm('Disconnect?')){localStorage.removeItem('tss_user');currentUser=null;chatMessages=[];chatLoaded=false;if(socket){socket.disconnect();socket=null}pageHistory=[];nav('pg-login','anim-fade',false)}}

/* ‚ïê‚ïê‚ïê HOME ‚ïê‚ïê‚ïê */
function setupHome(){
    if(!currentUser)return;var now=new Date(),h=now.getHours();
    var g='Good Evening',e='üåÜ';
    if(h<5){g='Sweet Dreams';e='üåô'}else if(h<12){g='Good Morning';e='üåÖ'}else if(h<17){g='Good Afternoon';e='‚òÄÔ∏è'}else if(h<21){g='Good Evening';e='üåÜ'}else{g='Good Night';e='üåô'}
    document.getElementById('greetEmoji').textContent=e;
    document.getElementById('greetName').innerHTML=g+', <span>'+currentUser.displayName+'</span>';
    document.getElementById('greetDate').textContent=days[now.getDay()]+', '+now.getDate()+' '+months[now.getMonth()];
    document.getElementById('greetTagline').textContent='"'+homeQuotes[Math.floor(Math.random()*homeQuotes.length)]+'"';
    document.getElementById('navAvatar').textContent=currentUser.username==='cavity'?'ü§¥':'üë∏';
    document.getElementById('dailyQuote').textContent='"'+homeQuotes[Math.floor(Math.random()*homeQuotes.length)]+'"';
    setTimeout(function(){var p=Math.floor(Math.random()*12)+88;document.getElementById('syncPct').textContent=p+'%';document.getElementById('syncBar').style.width=p+'%'},800);
    checkUnread();checkLetterUnread();
    initMoodPicker('letterMoods','letter');initMoodPicker('confMoods','conf');
}

/* ‚ïê‚ïê‚ïê SOCKET ‚ïê‚ïê‚ïê */
function connectSocket(){
    if(socket)return;socket=io();
    socket.on('connect',function(){if(currentUser)socket.emit('user-online',currentUser.username)});
    socket.on('online-status',function(u){var p=getPartner();partnerOnline=u.indexOf(p)!==-1;
    document.getElementById('statusDot').className='status-dot '+(partnerOnline?'s-on':'s-off');
    document.getElementById('statusText').textContent=partnerOnline?'online':'away';
    var cd=document.getElementById('chatStatusDot');if(cd){cd.className='status-dot '+(partnerOnline?'s-on':'s-off');document.getElementById('chatStatusText').textContent=partnerOnline?'online':'offline'}});
    socket.on('receive-message',function(m){chatMessages.push(m);if(currentPage==='pg-chat'){appendMsg(m);scrollChat();markRead()}else{checkUnread();playNotif()}});
    socket.on('message-sent',function(m){chatMessages.push(m);if(currentPage==='pg-chat'){appendMsg(m);scrollChat()}});
    socket.on('partner-typing',function(v){var el=document.getElementById('typingWrap');if(v){el.classList.add('show');scrollChat()}else el.classList.remove('show')});
    socket.on('partner-read',function(){document.querySelectorAll('.msg-check').forEach(function(c){c.classList.add('read')})});
    socket.on('new-letter',function(){if(currentPage!=='pg-letters')checkLetterUnread();else loadLetters();playNotif()});
    socket.on('new-confession',function(){if(currentPage==='pg-confess')loadConf()});
}
function getPartner(){return currentUser.username==='cavity'?'cingam':'cavity'}
function getPartnerName(){return getPartner()==='cavity'?'Cavity':'Cingam'}

/* ‚ïê‚ïê‚ïê CHAT ‚ïê‚ïê‚ïê */
function openChat(){
    document.getElementById('chatName').textContent=getPartnerName();
    document.getElementById('chatAvatar').textContent=getPartner()==='cavity'?'ü§¥':'üë∏';
    document.getElementById('chatStatusDot').className='status-dot '+(partnerOnline?'s-on':'s-off');
    document.getElementById('chatStatusText').textContent=partnerOnline?'online':'offline';
    if(!chatLoaded)loadChatHist();else{renderChat();markRead()}
    var inp=document.getElementById('chatInp');inp.value='';
    inp.oninput=handleTyping;inp.onkeydown=function(e){if(e.key==='Enter')sendMsg()};updateSendBtn();
}
function leaveChat(){if(socket)socket.emit('stop-typing',{receiver:getPartner()});goBack()}
async function loadChatHist(){
    var c=document.getElementById('chatMsgs');c.innerHTML='<div style="display:flex;align-items:center;justify-content:center;height:100%"><div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div></div>';
    try{var r=await fetch('/api/messages');var d=await r.json();if(d.success){chatMessages=d.messages;chatLoaded=true;renderChat();markRead()}}catch(e){}
}
function renderChat(){
    var c=document.getElementById('chatMsgs');c.innerHTML='';
    if(!chatMessages.length){c.innerHTML='<div class="chat-empty"><div class="chat-empty-icon">üí¨</div><div class="chat-empty-text">No messages yet</div><div class="chat-empty-sub">say something sweet...</div></div>';return}
    var ld='';chatMessages.forEach(function(m){var d=new Date(m.timestamp),ds=fmtDate(d);if(ds!==ld){addDateSep(c,ds);ld=ds}addMsgEl(c,m,false)});scrollChat();
}
function appendMsg(m){var c=document.getElementById('chatMsgs');var e=c.querySelector('.chat-empty');if(e)e.remove();var d=new Date(m.timestamp),ds=fmtDate(d);var seps=c.querySelectorAll('.msg-date-sep');var ls=seps.length?seps[seps.length-1].textContent.trim():'';if(ds!==ls)addDateSep(c,ds);addMsgEl(c,m,true)}
function addDateSep(c,s){var el=document.createElement('div');el.className='msg-date-sep';el.innerHTML='<span>'+s+'</span>';c.appendChild(el)}
function addMsgEl(c,m,a){var s=m.sender===currentUser.username;var r=document.createElement('div');r.className='msg-row '+(s?'sent':'received');if(!a)r.style.animation='none';var t=new Date(m.timestamp);r.innerHTML='<div class="msg-bubble"><div class="msg-text">'+esc(m.message)+'</div><div class="msg-time">'+pad(t.getHours())+':'+pad(t.getMinutes())+' '+(s?'<span class="msg-check'+(m.read?' read':'')+'">‚úì‚úì</span>':'')+'</div></div>';c.appendChild(r)}
function scrollChat(){var c=document.getElementById('chatMsgs');setTimeout(function(){c.scrollTop=c.scrollHeight},60)}
function sendMsg(){var inp=document.getElementById('chatInp');var t=inp.value.trim();if(!t||!socket)return;socket.emit('send-message',{sender:currentUser.username,receiver:getPartner(),message:t});inp.value='';updateSendBtn();socket.emit('stop-typing',{receiver:getPartner()})}
function handleTyping(){updateSendBtn();if(!socket)return;socket.emit('typing',{receiver:getPartner()});clearTimeout(typingTimer);typingTimer=setTimeout(function(){socket.emit('stop-typing',{receiver:getPartner()})},2000)}
function updateSendBtn(){var b=document.getElementById('chatSend');document.getElementById('chatInp').value.trim()?b.classList.remove('disabled'):b.classList.add('disabled')}
async function markRead(){try{await fetch('/api/messages/read',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:currentUser.username})});if(socket)socket.emit('messages-read',{sender:getPartner()});updateBadge('chatBadge',0)}catch(e){}}
async function checkUnread(){try{var r=await fetch('/api/unread/'+currentUser.username);var d=await r.json();if(d.success)updateBadge('chatBadge',d.count)}catch(e){}}

/* ‚ïê‚ïê‚ïê LETTERS ‚ïê‚ïê‚ïê */
function showWriteLetter(){nav('pg-write-letter');selLetterMood='üíï';highlightMood('letterMoods','üíï')}
async function loadLetters(){
    var list=document.getElementById('letterList');list.innerHTML='<div style="text-align:center;padding:40px"><div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div></div>';
    try{var r=await fetch('/api/letters/'+currentUser.username);var d=await r.json();
    if(d.success){var filtered=d.letters.filter(function(l){return letterTab==='inbox'?l.receiver===currentUser.username:l.sender===currentUser.username});
    list.innerHTML='';if(!filtered.length){list.innerHTML='<div class="letter-empty"><span class="letter-empty-icon">üíå</span><div class="letter-empty-text">'+(letterTab==='inbox'?'No letters yet':'No sent letters')+'</div></div>';return}
    filtered.forEach(function(l,i){var el=document.createElement('div');el.className='glass letter-item'+(l.read?'':' unread');el.style.animationDelay=(i*.06)+'s';
    var isUnread=letterTab==='inbox'&&!l.read;
    el.innerHTML='<span class="letter-mood">'+l.mood+'</span><div class="letter-title">'+esc(l.title)+'</div><div class="letter-preview">'+esc(l.content)+'</div><div class="letter-meta">'+(letterTab==='inbox'?'From '+l.sender:'To '+l.receiver)+' ¬∑ '+timeAgo(l.timestamp)+'</div>'+(isUnread?'<div class="letter-new-dot"></div>':'');
    el.onclick=function(){openLetter(l)};list.appendChild(el)})}}catch(e){}
}
function switchLetterTab(tab){letterTab=tab;document.getElementById('ltabInbox').classList.toggle('active',tab==='inbox');document.getElementById('ltabSent').classList.toggle('active',tab==='sent');loadLetters()}
function openLetter(l){
    nav('pg-read-letter');
    var b=document.getElementById('readLetterBody');
    b.innerHTML='<span class="read-letter-mood">'+l.mood+'</span><div class="read-letter-title">'+esc(l.title)+'</div><div class="read-letter-from">'+(l.sender===currentUser.username?'written by you':'from '+l.sender)+' ¬∑ '+fmtDateTime(l.timestamp)+'</div><div class="read-letter-content glass">'+esc(l.content)+'</div><div class="read-letter-date">'+fmtDateTime(l.timestamp)+'</div>';
    if(!l.read&&l.receiver===currentUser.username){fetch('/api/letters/open',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:l._id})})}
}
async function sendLetter(){
    var btn=document.getElementById('btnSendLetter');var title=document.getElementById('letterTitle').value.trim();
    var content=document.getElementById('letterContent').value.trim();
    if(!content){alert('Write something!');return}
    btn.classList.add('loading');
    try{var r=await fetch('/api/letters',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({sender:currentUser.username,receiver:getPartner(),title:title||'Untitled Letter',content:content,mood:selLetterMood})});
    var d=await r.json();btn.classList.remove('loading');
    if(d.success){if(socket)socket.emit('letter-sent',{receiver:getPartner()});document.getElementById('letterTitle').value='';document.getElementById('letterContent').value='';goBack();setTimeout(loadLetters,300)}}catch(e){btn.classList.remove('loading')}
}
async function checkLetterUnread(){try{var r=await fetch('/api/letters/unread/'+currentUser.username);var d=await r.json();if(d.success)updateBadge('letterBadge',d.count)}catch(e){}}

/* ‚ïê‚ïê‚ïê CONFESSIONS ‚ïê‚ïê‚ïê */
function showWriteConf(){nav('pg-write-conf');selConfMood='üí≠';highlightMood('confMoods','üí≠')}
async function loadConf(){
    var list=document.getElementById('confList');list.innerHTML='<div style="text-align:center;padding:40px"><div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div></div>';
    try{var r=await fetch('/api/confessions');var d=await r.json();
    if(d.success){list.innerHTML='';if(!d.confessions.length){list.innerHTML='<div class="letter-empty"><span class="letter-empty-icon">ü§´</span><div class="letter-empty-text">No confessions yet</div></div>';return}
    d.confessions.forEach(function(c,i){var el=document.createElement('div');el.className='glass conf-item';el.style.animationDelay=(i*.06)+'s';
    var hearted=c.heartedBy&&c.heartedBy.indexOf(currentUser.username)!==-1;
    el.innerHTML='<span class="conf-mood">'+c.mood+'</span><div class="conf-content">'+esc(c.content)+'</div><div class="conf-footer"><span class="conf-meta">'+c.author+' ¬∑ '+timeAgo(c.timestamp)+'</span><button class="conf-heart-btn'+(hearted?' hearted':'')+'" onclick="heartConf(\''+c._id+'\',this)">‚ô° <span>'+c.hearts+'</span></button></div>';
    list.appendChild(el)})}}catch(e){}
}
async function postConf(){
    var btn=document.getElementById('btnPostConf');var content=document.getElementById('confContent').value.trim();
    if(!content){alert('Write something!');return}
    btn.classList.add('loading');
    try{var r=await fetch('/api/confessions',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({author:currentUser.displayName,content:content,mood:selConfMood})});
    var d=await r.json();btn.classList.remove('loading');
    if(d.success){if(socket)socket.emit('confession-posted',{});document.getElementById('confContent').value='';goBack();setTimeout(loadConf,300)}}catch(e){btn.classList.remove('loading')}
}
async function heartConf(id,btn){
    try{var r=await fetch('/api/confessions/heart',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:id,username:currentUser.username})});
    var d=await r.json();if(d.success){btn.querySelector('span').textContent=d.hearts;btn.classList.toggle('hearted',d.hearted)}}catch(e){}
}

/* ‚ïê‚ïê‚ïê TRUTH & DARE ‚ïê‚ïê‚ïê */
function getTod(type){
    var card=document.getElementById('todCard');card.classList.remove('tod-flip');void card.offsetWidth;card.classList.add('tod-flip');
    var isTruth=type==='truth'||(type==='random'&&Math.random()>.5);
    var pool=isTruth?truths:dares;var item=pool[Math.floor(Math.random()*pool.length)];
    setTimeout(function(){
        document.getElementById('todEmoji').textContent=isTruth?'üü¢':'üî¥';
        document.getElementById('todType').textContent=isTruth?'Truth':'Dare';
        document.getElementById('todType').className='tod-type '+(isTruth?'truth':'dare');
        document.getElementById('todQ').textContent=item.q;
        document.getElementById('todCat').textContent='‚åò '+item.c;
    },250);
}

/* ‚ïê‚ïê‚ïê QUOTES ‚ïê‚ïê‚ïê */
async function loadQuotes(){
    var list=document.getElementById('quotesList');list.innerHTML='<div style="text-align:center;padding:40px"><div class="sp-loader"><div class="sp-ldot"></div><div class="sp-ldot"></div><div class="sp-ldot"></div></div></div>';
    try{var r=await fetch('/api/quotes');var d=await r.json();
    if(d.success){list.innerHTML='';d.quotes.forEach(function(q,i){
    var hearted=q.heartedBy&&q.heartedBy.indexOf(currentUser.username)!==-1;
    var el=document.createElement('div');el.className='glass qt-item';el.style.animationDelay=(i*.05)+'s';
    el.innerHTML='<span class="qt-mark">"</span><div class="qt-text">'+esc(q.quote)+'</div>'+(q.author?'<div class="qt-author">‚Äî '+esc(q.author)+'</div>':'')+'<div class="qt-footer"><button class="qt-heart-btn'+(hearted?' hearted':'')+'" onclick="heartQuote(\''+q._id+'\',this)">‚ô° <span>'+q.hearts+'</span></button>'+(q.addedBy!=='system'?'<span class="qt-added">added by '+q.addedBy+'</span>':'')+'</div>';
    list.appendChild(el)})}}catch(e){}
}
function showAddQuote(){nav('pg-add-quote')}
async function addQuote(){
    var btn=document.getElementById('btnAddQuote');var qt=document.getElementById('newQuoteText').value.trim();var au=document.getElementById('newQuoteAuthor').value.trim();
    if(!qt){alert('Write a quote!');return}
    btn.classList.add('loading');
    try{var r=await fetch('/api/quotes',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({addedBy:currentUser.displayName,quote:qt,author:au})});
    var d=await r.json();btn.classList.remove('loading');
    if(d.success){document.getElementById('newQuoteText').value='';document.getElementById('newQuoteAuthor').value='';goBack();setTimeout(loadQuotes,300)}}catch(e){btn.classList.remove('loading')}
}
async function heartQuote(id,btn){
    try{var r=await fetch('/api/quotes/heart',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:id,username:currentUser.username})});
    var d=await r.json();if(d.success){btn.querySelector('span').textContent=d.hearts;btn.classList.toggle('hearted',d.hearted)}}catch(e){}
}

/* ‚ïê‚ïê‚ïê MOOD PICKER ‚ïê‚ïê‚ïê */
function initMoodPicker(containerId,type){
    var c=document.getElementById(containerId);c.innerHTML='';
    moodOptions.forEach(function(m){var el=document.createElement('div');el.className='mood-opt'+(m===(type==='letter'?selLetterMood:selConfMood)?' sel':'');el.textContent=m;
    el.onclick=function(){if(type==='letter')selLetterMood=m;else selConfMood=m;highlightMood(containerId,m)};c.appendChild(el)});
}
function highlightMood(cid,m){document.querySelectorAll('#'+cid+' .mood-opt').forEach(function(el){el.classList.toggle('sel',el.textContent===m)})}

/* ‚ïê‚ïê‚ïê HELPERS ‚ïê‚ïê‚ïê */
function updateBadge(id,count){var b=document.getElementById(id);if(!b)return;if(count>0){b.textContent=count>9?'9+':count;b.style.display='flex'}else b.style.display='none'}
function fmtDate(d){var t=new Date(),y=new Date(t);y.setDate(y.getDate()-1);if(d.toDateString()===t.toDateString())return'Today';if(d.toDateString()===y.toDateString())return'Yesterday';return d.getDate()+' '+months[d.getMonth()]}
function fmtDateTime(ts){var d=new Date(ts);return d.getDate()+' '+months[d.getMonth()]+' '+d.getFullYear()+', '+pad(d.getHours())+':'+pad(d.getMinutes())}
function timeAgo(ts){var d=Date.now()-new Date(ts).getTime();var m=Math.floor(d/60000);if(m<1)return'just now';if(m<60)return m+'m ago';var h=Math.floor(m/60);if(h<24)return h+'h ago';var dy=Math.floor(h/24);if(dy<7)return dy+'d ago';return fmtDate(new Date(ts))}
function pad(n){return n<10?'0'+n:''+n}
function esc(t){var d=document.createElement('div');d.textContent=t;return d.innerHTML}
function playNotif(){try{var c=new(window.AudioContext||window.webkitAudioContext)();var o=c.createOscillator(),g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=880;o.type='sine';g.gain.setValueAtTime(0.08,c.currentTime);g.gain.exponentialRampToValueAtTime(0.001,c.currentTime+0.4);o.start(c.currentTime);o.stop(c.currentTime+0.4);var o2=c.createOscillator(),g2=c.createGain();o2.connect(g2);g2.connect(c.destination);o2.frequency.value=1100;o2.type='sine';g2.gain.setValueAtTime(0.06,c.currentTime+0.15);g2.gain.exponentialRampToValueAtTime(0.001,c.currentTime+0.5);o2.start(c.currentTime+0.15);o2.stop(c.currentTime+0.5)}catch(e){}}

/* ‚ïê‚ïê‚ïê PARTICLES ‚ïê‚ïê‚ïê */
function startPtc(){var c=document.getElementById('ptcBg');var h=['‚ô°','‚ô•','‚ú¶','‚ãÜ','‚úß','¬∑'];function make(){var el=document.createElement('div');var r=Math.random();if(r<.3){el.className='ptc ptc-heart';el.textContent=h[Math.floor(Math.random()*2)];el.style.fontSize=(Math.random()*10+6)+'px'}else if(r<.6){el.className='ptc ptc-star';el.textContent=h[2+Math.floor(Math.random()*3)];el.style.fontSize=(Math.random()*8+4)+'px'}else{el.className='ptc ptc-dot';var s=Math.random()*2.5+1;el.style.width=s+'px';el.style.height=s+'px'}el.style.left=Math.random()*100+'vw';el.style.animationDuration=(Math.random()*14+14)+'s';el.style.animationDelay=Math.random()*5+'s';c.appendChild(el);setTimeout(function(){el.remove()},32000)}for(var i=0;i<8;i++)setTimeout(make,i*300);setInterval(make,2000)}

/* ‚ïê‚ïê‚ïê RIPPLE ‚ïê‚ïê‚ïê */
document.addEventListener('touchstart',function(e){var t=e.target.closest('.section-card,.liquid-btn,.btn-back,.quick-btn,.nav-avatar,.chat-send,.tod-btn,.l-tab,.letter-item,.pg-header-btn,.mood-opt,.conf-heart-btn,.qt-heart-btn');if(!t)return;var r=t.getBoundingClientRect(),tc=e.touches[0],rip=document.createElement('div');rip.className='ripple';var sz=Math.max(r.width,r.height)*2.5;rip.style.width=rip.style.height=sz+'px';rip.style.left=(tc.clientX-r.left-sz/2)+'px';rip.style.top=(tc.clientY-r.top-sz/2)+'px';t.style.position=t.style.position||'relative';t.appendChild(rip);setTimeout(function(){rip.remove()},700)},{passive:true});

/* ‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê */
function init(){startPtc();var s=localStorage.getItem('tss_user');setTimeout(function(){if(s){try{currentUser=JSON.parse(s);setupHome();connectSocket();nav('pg-home','anim-scale',false)}catch(e){localStorage.removeItem('tss_user');nav('pg-login','anim-fade',false)}}else nav('pg-login','anim-fade',false)},3000)}
init();
</script>
</body>
</html>
